!function(e){var t={};function s(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=26)}([function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return r})),s.d(t,"f",(function(){return l})),s.d(t,"g",(function(){return h})),s.d(t,"e",(function(){return c}));let a={};function n(e){let t=e.callback_id,s=a[t];delete a[t],s(e.response_data)}function i(e,t,s){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:s})}function o(e,t){return new Promise((function(s,a){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:e=>{e.success&&s(e),a(e)}})}))}function r(e,t){return new Promise((function(s,a){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,type:"POST",data:t,contentType:!1,processData:!1,success:e=>{e.success&&s(e),a(e)}})}))}function l(e,t,s,n){const i={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,expiration:null};if(void 0!==n&&null!=n){const e=guid();a[e]=n,i.callback_id=e,i.callback_type="callback_no_context"}else i.callback_id=null,i.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(i),dataType:"json"})}function c(e,t,s){const a={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,callback_id:null,callback_type:"no_callback",expiration:null};$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!1,data:JSON.stringify(a),dataType:"json"})}function h(e,t,s,n){const i={source:"client",dest:e,task_type:t,task_data:s,response_data:null,expiration:null};if(void 0!==n){const e=guid();a[e]=n,i.callback_id=e,i.callback_type="callback_no_context"}else i.callback_id=null,i.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(i),dataType:"json"})}},function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return c})),s.d(t,"c",(function(){return r}));var a=window.ReactBootstrap;class n extends React.Component{constructor(e){super(e),doBinding(this);let t=this.props.default_value;for(var s=1;this.name_exists(t);)s+=1,t=this.props.default_value+String(s);this.state={show:!1,current_value:t,checkbox_states:{},warning_text:""}}_changeHandler(e){this.setState({current_value:e.target.value})}_checkbox_change_handler(e){e.target.checked;let t=Object.assign({},this.state.checkbox_states);t[e.target.id]=e.target.checked,this.setState({checkbox_states:t})}componentDidMount(){if(this.setState({show:!0}),null!=this.props.checkboxes&&0!=this.props.checkboxes.length){let e={};for(let t of this.props.checkboxes)e[t.id]=!1;this.setState({checkbox_states:e})}}name_exists(e){return this.props.existing_names.indexOf(e)>-1}_submitHandler(e){let t;""==this.state.current_value?(t="An empty name is not allowed here.",this.setState({warning_text:t})):this.name_exists(this.state.current_value)?(t="That name already exists",this.setState({warning_text:t})):(this.setState({show:!1}),this.props.handleSubmit(this.state.current_value,this.state.checkbox_states),this.props.handleClose())}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){let e=[];if(null!=this.props.checkboxes&&0!=this.props.checkboxes.length)for(let t of this.props.checkboxes){let s=React.createElement(a.Form.Check,{type:"checkbox",label:t.checktext,id:t.checkname,key:t.checkname,onChange:this._checkbox_change_handler});e.push(s)}return React.createElement(a.Modal,{show:this.state.show},React.createElement(a.Modal.Header,{closeButton:!0},React.createElement(a.Modal.Title,null,this.props.title)),React.createElement(a.Modal.Body,null,React.createElement(a.Form.Group,{onSubmit:this._submitHandler},React.createElement(a.Form.Label,null,this.props.field_title),React.createElement(a.Form,null,React.createElement(a.Form.Control,{type:"text",onChange:this._changeHandler,value:this.state.current_value}))),0!=e.length&&e),React.createElement(a.Modal.Footer,null,React.createElement(a.Form.Text,{className:"text-muted"},this.state.warning_text),React.createElement(a.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function i(e,t,s,a,i,o=null){void 0===i&&(i=[]);let r=document.querySelector("#modal-area");ReactDOM.render(React.createElement(n,{handleSubmit:s,handleClose:function(){ReactDOM.unmountComponentAtNode(r)},title:e,field_title:t,default_value:a,checkboxes:o,existing_names:i}),r)}n.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,field_title:PropTypes.string,default_value:PropTypes.string,existing_names:PropTypes.array,checkboxes:PropTypes.array},n.defaultProps={existing_names:[],default_value:"",checkboxes:null};class o extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1,value:null}}componentDidMount(){this.setState({show:!0,value:this.props.option_list[0]})}_handleChange(e){this.setState({value:e.target.value})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(this.state.value),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(a.Modal,{show:this.state.show},React.createElement(a.Modal.Header,{closeButton:!0},React.createElement(a.Modal.Title,null,this.props.title)),React.createElement(a.Modal.Body,null,React.createElement(a.Form.Group,null,React.createElement(a.Form.Label,null,"Select Label"),React.createElement(a.Form.Control,{as:"select",onChange:this._handleChange,value:this.state.value},this.props.option_list.map((e,t)=>React.createElement("option",{key:t},e))))),React.createElement(a.Modal.Footer,null,React.createElement(a.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function r(e,t,s,a,n,i){let r=document.querySelector("#modal-area");ReactDOM.render(React.createElement(o,{handleSubmit:n,handleClose:function(){ReactDOM.unmountComponentAtNode(r)},title:e,select_label:t,submit_text:a,option_list:i,cancel_text:s}),r)}o.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,select_label:PropTypes.string,option_list:PropTypes.array,submit_text:PropTypes.string,cancel_text:PropTypes.string};class l extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1}}componentDidMount(){this.setState({show:!0})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(a.Modal,{show:this.state.show},React.createElement(a.Modal.Header,{closeButton:!0},React.createElement(a.Modal.Title,null,this.props.title)),React.createElement(a.Modal.Body,null,React.createElement("p",null,this.props.text_body)),React.createElement(a.Modal.Footer,null,React.createElement(a.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function c(e,t,s,a,n){let i=document.querySelector("#modal-area");ReactDOM.render(React.createElement(l,{handleSubmit:n,handleClose:function(){ReactDOM.unmountComponentAtNode(i)},title:e,text_body:t,submit_text:a,cancel_text:s}),i)}confirmDialog.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,text_body:PropTypes.string,submit_text:PropTypes.string,cancel_text:PropTypes.string}},function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"d",(function(){return p})),s.d(t,"a",(function(){return n}));var a=window.ReactBootstrap;class n extends React.Component{render(){return React.createElement("button",{type:"button",style:this.props.style,className:this.props.butclass,onMouseDown:e=>{e.preventDefault()},onClick:this.props.handleClick},React.createElement("span",{className:this.props.icon_class}),this.props.extra_glyph_text&&React.createElement("span",{className:"extra-glyph-text"},this.props.extra_glyph_text))}}n.propTypes={butclass:PropTypes.string,icon_class:PropTypes.string,extra_glyph_text:PropTypes.string,style:PropTypes.object,handleClick:PropTypes.func},n.defaultProps={style:{},extra_glyph_text:null};(class extends React.Component{constructor(e){super(e),doBinding(this),this.state={xpos:0,ypos:0,initial_x:null,initial_y:null,active:!1}}_dragStart(e){this.setState({initial_x:e.clientX,initial_y:e.clientY,active:!0})}_drag(e){if(this.state.active){let t=e.clientX-this.state.initial_x,s=e.clientY-this.state.initial_y;this.setState({xpos:t,ypos:s})}}_dragEnd(e){this.setState({active:!1,xpos:0,ypos:0})}render(){let e={fontSize:25};return this.state.active&&(e.transform="translate3d("+this.state.xpos+"px, "+this.state.ypos+"px, 0)"),React.createElement("span",{style:e,onMouseDown:this._dragStart,onMouseMove:this._drag,onMouseUp:this._dragEnd,className:"fal fa-caret-right"})}}).propTypes={handleDrag:PropTypes.func};class i extends React.Component{render(){let e=this.props.show?"form-group m-1":"form-group m-1 d-none";return React.createElement(a.Form.Group,{bsPrefix:e},React.createElement(a.Form.Label,{bsPrefix:"form-label m-1"},this.props.label),React.createElement(a.Form.Control,{as:"input",onChange:this.props.onChange,value:this.props.the_value}))}}function o(e){return React.createElement(a.Form.Group,{bsPrefix:"form-group m-1"},React.createElement(a.Form.Label,{bsPrefix:"form-label m-1"},e.label),React.createElement(r,{option_list:e.option_list,onChange:e.onChange,the_value:e.the_value}))}i.propTypes={show:PropTypes.bool,label:PropTypes.string,onChange:PropTypes.func,the_value:PropTypes.string},i.defaultProps={show:!0};class r extends React.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e.target.value)}render(){let e={marginBottom:5,width:"auto"};null!=this.props.height&&(e.height=this.props.height),null!=this.props.maxWidth&&(e.maxWidth=this.props.maxWidth),null!=this.props.fontSize&&(e.fontSize=this.props.fontSize);let t=this.props.option_list.map((e,t)=>React.createElement("option",{key:t},e));return React.createElement(a.Form.Control,{as:"select",style:e,onChange:this.handleChange,value:this.props.value},t)}}r.propTypes={option_list:PropTypes.array,onChange:PropTypes.func,value:PropTypes.string,height:PropTypes.number,maxWidth:PropTypes.number,fontSize:PropTypes.number},r.defaultProps={height:null,maxWidth:null,fontSize:null};(class extends React.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.handleChange(e.target.value)}render(){let e=this.props.option_list.map((e,t)=>React.createElement("option",{key:t},e));return React.createElement("select",{style:{marginBottom:5,width:"auto"},className:"form-control",onChange:this.handleChange,value:this.props.value},e)}}).propTypes={option_list:PropTypes.array,handleChange:PropTypes.func,value:PropTypes.string};class l extends React.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this),this.td_ref=React.createRef()}handleChange(e){let t=this.td_ref.current.innerHTML.trim();this.props.handleCellChange(this.props.theRow,this.props.theCol,t)}render(){return React.createElement("td",{contentEditable:this.props.content_editable,onBlur:this.handleChange,ref:this.td_ref,suppressContentEditableWarning:!0},this.props.children)}}l.propTypes={content_editable:PropTypes.bool,handleCellChange:PropTypes.func,theRow:PropTypes.number,theColumn:PropTypes.string};class c extends React.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(){this.props.handleRowClick(this.props.row_index)}render(){let e=this.props.columns.map((e,t)=>React.createElement(l,{key:t,content_editable:this.props.content_editable,theRow:this.props.row_index,theCol:e,handleCellChange:this.props.handleCellChange},this.props.data_dict[e]));e.push(React.createElement("td",{key:"999"},React.createElement("span",{className:"ui-icon ui-icon-arrowthick-2-n-s"})));let t=this.props.active?"selector-button active":"selector-button";return React.createElement("tr",{className:t,id:this.props.row_index,onClick:this.handleClick},e)}}c.propTypes={columns:PropTypes.array,row_index:PropTypes.number,data_dict:PropTypes.object,active:PropTypes.bool,handleRowClick:PropTypes.func,content_editable:PropTypes.bool,handleCellChange:PropTypes.func},c.defaultProps={content_editable:!1};class h extends React.Component{render(){let e=this.props.columns.map((e,t)=>React.createElement("th",{key:t},e));return e.push(React.createElement("th",{key:"999"}," ")),React.createElement("thead",null,React.createElement("tr",{className:"selector-button",key:"header"},e))}}h.propTypes={columns:PropTypes.array};class p extends React.Component{constructor(e){super(e),this.tbody_ref=React.createRef(),this.update_option_order=this.update_option_order.bind(this),this.handleCellChange=this.handleCellChange.bind(this)}componentDidMount(){$(this.tbody_ref.current).sortable({handle:".ui-icon",update:this.update_option_order})}handleCellChange(e,t,s){let a=this.props.data_array;a[e][t]=s,this.props.handleChange(a)}update_option_order(e,t){let s=$(this.tbody_ref.current).sortable("toArray"),a=s.indexOf(String(this.props.active_row)),n=s.map((e,t)=>this.props.data_array[parseInt(e)]);this.props.handleChange(n),this.props.handleActiveRowChange(a)}render(){let e=this.props.data_array.map((e,t)=>React.createElement(c,{columns:this.props.columns,data_dict:e,key:e[this.props.columns[0]],row_index:t,active:t==this.props.active_row,handleRowClick:this.props.handleActiveRowChange,content_editable:this.props.content_editable,handleCellChange:this.handleCellChange}));return React.createElement("table",{className:"tile-table table sortable table-striped table-bordered table-sm"},React.createElement(h,{columns:this.props.columns}),React.createElement("tbody",{ref:this.tbody_ref},e))}}p.propTypes={columns:PropTypes.array,data_array:PropTypes.array,active_row:PropTypes.number,handleActiveRowChange:PropTypes.func,handleChange:PropTypes.func,content_editable:PropTypes.bool},p.defaultProps={content_editable:!1}},function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return n}));React.createContext({width:window.innerWidth,height:window.innerHeight});class a extends React.Component{constructor(e){super(e),this.left_pane_ref=React.createRef(),this.right_pane_ref=React.createRef(),this.old_left_width=0,this.old_right_width=0,this.state=this.state={current_width_fraction:this.props.initial_width_fraction,mounted:!1}}componentDidMount(){this.turn_on_horizontal_resize(),window.addEventListener("resize",this.resize_to_window),this.setState({mounted:!0})}componentDidUpdate(){this.notifySplitUpate()}turn_on_horizontal_resize(){let e=this;$(this.left_pane_ref.current).resizable({handles:"e",resize:function(t,s){let a=1*s.size.width/e.props.available_width;s.position.left=s.originalPosition.left,e.update_width_fraction(a)}})}get left_width(){return this.props.available_width*this.state.current_width_fraction}get right_width(){return(1-this.state.current_width_fraction)*this.props.available_width}update_width_fraction(e){this.setState({current_width_fraction:e})}get width_has_changed(){return this.left_width!=this.old_left_width||this.right_width!=this.old_right_width}notifySplitUpate(){this.width_has_changed&&null!=this.props.handleSplitUpdate&&(this.old_left_width=this.left_width,this.old_right_width=this.right_width,this.props.handleSplitUpdate(this.left_width,this.right_width,this.state.current_width_fraction))}render(){let e={width:this.left_width,height:this.props.available_height},t={width:this.right_width,height:this.props.available_height};this.props.hide_me;return React.createElement("div",{className:"d-flex flex-row"},React.createElement("div",{ref:this.left_pane_ref,style:e,className:"res-viewer-resizer"},this.props.left_pane),React.createElement("div",{ref:this.right_pane_ref,style:t},this.props.right_pane))}}a.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,left_pane:PropTypes.object,right_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_width_fraction:PropTypes.number},a.defaultProps={handleSplitUpdate:null,initial_width_fraction:.5,hide_me:!1};class n extends React.Component{constructor(e){super(e),this.top_pane_ref=React.createRef(),this.bottom_pane_ref=React.createRef(),this.old_bottom_height=0,this.old_top_height=0,this.state=this.state={current_height_fraction:this.props.initial_height_fraction,mounted:!1}}componentDidMount(){this.turn_on_vertical_resize(),this.setState({mounted:!0}),window.addEventListener("resize",this.resize_to_window)}componentDidUpdate(){this.notifySplitUpate()}turn_on_vertical_resize(){let e=this;$(this.top_pane_ref.current).resizable({handles:"s",resize:function(t,s){let a=1*s.size.height/e.props.available_height;e.update_height_fraction(a)}})}get top_height(){return this.props.available_height*this.state.current_height_fraction}get bottom_height(){return(1-this.state.current_height_fraction)*this.props.available_height}notifySplitUpate(){null!=this.props.handleSplitUpdate&&this.height_has_changed&&(this.old_top_height=this.top_height,this.old_bottom_height=this.bottom_height,this.props.handleSplitUpdate(this.top_height,this.bottom_height,this.state.current_height_fraction))}update_height_fraction(e){this.setState({current_height_fraction:e})}get height_has_changed(){return this.top_height!=this.old_top_height||this.bottom_height!=this.old_bottom_height}render(){let e={width:this.props.available_width,height:this.top_height,borderBottom:"0.5px solid rgb(238, 238, 238)",overflowY:"scroll"};this.props.hide_top&&(e.display="none");let t={width:this.props.available_width,height:this.bottom_height,overflowY:"scroll"};return React.createElement("div",{className:"d-flex flex-column"},React.createElement("div",{ref:this.top_pane_ref,style:e},this.props.top_pane),React.createElement("div",{ref:this.bottom_pane_ref,style:t},this.props.bottom_pane))}}n.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,top_pane:PropTypes.object,hide_top:PropTypes.bool,bottom_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_height_fraction:PropTypes.number},n.defaultProps={handleSplitUpdate:null,initial_height_fraction:.5,hide_top:!1}},function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a=React.createContext({readOnly:!1})},function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));class a{constructor(e,t){this.name_space=e,this.recInterval=null,this.retry_interval=t,this.connectme(),this.initialize_socket_stuff(),this.watchForDisconnect()}connectme(){use_ssl?this.socket=io.connect(`https://${document.domain}:${location.port}/${this.name_space}`):this.socket=io.connect(`http://${document.domain}:${location.port}/${this.name_space}`)}initialize_socket_stuff(){}watchForDisconnect(){let e=this;this.socket.on("disconnect",(function(){doFlash({message:"lost server connection"}),e.socket.close(),e.recInterval=setInterval((function(){e.attemptReconnect()}),e.retry_interval)}))}attemptReconnect(){this.socket.connected?(clearInterval(this.recInterval),this.initialize_socket_stuff(),this.watchForDisconnect(),doFlash({message:"reconnected to server"})):this.connectme()}}},function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));var a=window.ReactBootstrap;let n=$SCRIPT_ROOT+"/library",i=$SCRIPT_ROOT+"/repository",o=$SCRIPT_ROOT+"/account_info",r=$SCRIPT_ROOT+"/login";class l extends React.Component{handle_signout(){doSignOut(window.page_id)}render(){let e=React.createElement(React.Fragment,null,React.createElement(a.Nav.Item,null,React.createElement(a.Nav.Link,{href:n},"My Resources")),React.createElement(a.Nav.Item,null,React.createElement(a.Nav.Link,{href:i},"Repository")),React.createElement(a.Nav.Item,null,React.createElement(a.Nav.Link,{href:o},this.props.user_name)),React.createElement(a.Nav.Item,null,React.createElement(a.Nav.Link,{onClick:this.handle_signout},"Logout"))),t=(React.createElement(a.Nav.Item,null,React.createElement(a.Nav.Link,{href:r},"Login")),null==this.props.menus?"justify-content-end":"justify-content-between");return React.createElement(a.Navbar,{bg:"light",expand:"lg",variant:"light"},React.createElement(a.Navbar.Brand,{href:"/"},React.createElement("img",{className:"mr-2",src:window.tactic_img_url,alt:"",width:"32 ",height:"32"}),"Tactic"),React.createElement(a.Navbar.Collapse,{id:"collapse-area",className:t},null!=this.props.menus&&React.createElement(a.Nav,{id:"menu-area"},this.props.menus),React.createElement(a.Nav,null,React.createElement(a.Nav.Link,{href:"http://tactic.readthedocs.io/en/latest/index.html"},"Docs"),this.props.is_authenticated&&e)))}}function c(){let e=document.querySelector("#navbar-root");ReactDOM.render(React.createElement(l,{is_authenticated:window.is_authenticated,user_name:window.username}),e)}l.propTypes={is_authenticated:PropTypes.bool,img_url:PropTypes.string,user_name:PropTypes.string,menus:PropTypes.object},l.defaultProps={menus:null}},function(e,t,s){"use strict";s.d(t,"c",(function(){return p})),s.d(t,"a",(function(){return d})),s.d(t,"b",(function(){return r}));var a=s(1),n=s(0);const i="btn-outline-secondary";var o=window.ReactBootstrap;function r(e){return React.createElement("div",{style:{marginTop:20}},React.createElement(p,{button_groups:e.button_groups}),React.createElement(d,{resource_name:e.resource_name,res_type:e.res_type}))}class l extends React.Component{constructor(e){super(e)}render(){let e;return e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class,React.createElement(o.Button,{onClick:this.props.click_handler,className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name_text))}}l.propTypes={icon_name:PropTypes.string,click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,small_size:PropTypes.bool},l.defaultProps={small_size:!0};class c extends React.Component{constructor(e){super(e),doBinding(this)}render(){let e;e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class;let t=this.props.option_list.map((e,t)=>React.createElement(o.Dropdown.Item,{key:e.opt_name,onClick:e.opt_func},e.opt_name));return React.createElement(o.Dropdown,null,React.createElement(o.Dropdown.Toggle,{id:this.props.name,className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name)),React.createElement(o.Dropdown.Menu,null,t))}}c.propTypes={button_class:PropTypes.string,name:PropTypes.string,icon_name:PropTypes.string,option_list:PropTypes.array,small_size:PropTypes.bool},c.defaultProps={small_size:!0};class h extends React.Component{constructor(e){super(e),doBinding(this),this.state={file_list:null}}_handleFileChange(e){this.setState({file_list:e.target.files})}_do_submit(e){e.preventDefault(),this.props.click_handler(this.state.file_list)}render(){let e;e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class;let t=React.createElement(o.Form.Control,{as:"input",type:"file",size:"sm",style:{width:250,fontSize:12},onChange:this._handleFileChange,className:"form-control-sm "+this.props.button_class,multiple:this.props.multiple});return React.createElement(o.Form,{inline:!0},React.createElement(o.Button,{onClick:this._do_submit,type:"submit",className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name_text)),t)}}h.propTypes={click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,multiple:PropTypes.bool,icon_name:PropTypes.string,small_size:PropTypes.bool},h.defaultProps={small_size:!0,multiple:!1};class p extends React.Component{get_button_class(e){return null==e.button_class?i:e.button_class}render(){const e=[];var t=0;if(null!=this.props.popup_buttons&&0!=this.props.popup_buttons.length){let t=this.props.popup_buttons.map((e,t)=>React.createElement(o.ButtonGroup,{className:"toolbar-button-group",role:"group",key:"popup_group"+String(t)},React.createElement(c,{name:e.name,key:e.name,icon_name:e.icon_name,option_list:e.option_list,button_class:this.get_button_class(e)})));e.push(t)}for(let s of this.props.button_groups){let a=s.map((e,t)=>React.createElement(l,{name:e.name,icon_name:e.icon_name,click_handler:e.click_handler,button_class:this.get_button_class(e),name_text:e.name_text,key:t}));e.push(React.createElement(o.ButtonGroup,{className:"toolbar-button-group",role:"group",key:t},a)),t+=1}if(null!=this.props.file_adders&&0!=this.props.file_adders.length){let s=this.props.file_adders.map((e,t)=>React.createElement(h,{icon_name:e.icon_name,click_handler:e.click_handler,button_class:this.get_button_class(e),name_text:e.name_text,multiple:e.multiple,key:t}));e.push(React.createElement(o.ButtonGroup,{className:"toolbar-button-group",role:"group",key:t},s))}return React.createElement(o.ButtonToolbar,{className:"mb-2"},e)}}p.propTypes={button_groups:PropTypes.array,file_adders:PropTypes.array,popup_buttons:PropTypes.array},p.defaultProps={file_adders:null,popup_buttons:null};class d extends React.Component{constructor(e){super(e),this.state={current_name:e.resource_name},this.rename_me=this.rename_me.bind(this),this.RenameResource=null==this.props.handleRename?this.defaultRenameResource.bind(this):this.props.handleRename}rename_me(){console.log("entering rename");var e=this,t=this.props.res_type,s=this.state.current_name;$.getJSON($SCRIPT_ROOT+`get_resource_names/${t}`,(function(n){const i=n.resource_names,o=i.indexOf(s);o>=0&&i.splice(o,1),Object(a.b)(`Rename ${t}`,`Name for this ${t}`,e.RenameResource,s,i)}))}defaultRenameResource(e){const t={new_name:e};var s=this;Object(n.b)(`rename_resource/${this.props.res_type}/${this.state.current_name}`,t,(function(t){if(!t.success)return doFlash(t),!1;s.setState({current_name:e}),doFlash(t)}))}render(){let e=null==this.props.handleRename?this.state.current_name:this.props.resource_name;return React.createElement(o.Button,{id:"rename-button",className:"btn btn-outline-secondary res-name-button",onClick:this.rename_me},e)}}d.propTypes={resource_name:PropTypes.string,res_type:PropTypes.string,handleRename:PropTypes.func},d.defaultProps={handleRename:null}},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(0);class n extends React.Component{constructor(e){super(e),this.code_container_ref=React.createRef(),this.handleChange=this.handleChange.bind(this),this.mousetrap=new Mousetrap,this.create_api()}createCMArea(e,t=1){let s=CodeMirror(e,{lineNumbers:!0,matchBrackets:!0,highlightSelectionMatches:!0,autoCloseBrackets:!0,indentUnit:4,mode:this.props.mode,readOnly:this.props.readOnly});1!=t&&s.setOption("firstLineNumber",t);let a=Object.assign(this.props.extraKeys,{Tab:function(e){let t=new Array(5).join(" ");e.replaceSelection(t)},"Ctrl-Space":"autocomplete"});return s.setOption("extraKeys",a),s.setSize(null,"100%"),s.on("change",this.handleChange),s}handleChange(e,t){this.props.handleChange(e.getDoc().getValue())}componentDidMount(){this.cmobject=this.createCMArea(this.code_container_ref.current,this.props.first_line_number),this.cmobject.setValue(this.props.code_content),this.create_keymap(),null!=this.props.setCMObject&&this.props.setCMObject(this.cmobject)}componentDidUpdate(){this.props.sync_to_prop&&this.cmobject.setValue(this.props.code_content),1!=this.props.first_line_number&&this.cmobject.setOption("firstLineNumber",this.props.first_line_number),this.cmobject.refresh()}searchCM(){CodeMirror.commands.find(this.cmobject)}clearSelections(){CodeMirror.commands.clearSearch(this.cmobject),CodeMirror.commands.singleSelection(this.cmobject)}create_api(){let e=this;Object(a.b)("get_api_dict",{},(function(t){e.api_dict_by_category=t.api_dict_by_category,e.api_dict_by_name=t.api_dict_by_name,e.ordered_api_categories=t.ordered_api_categories,e.api_list=[];for(let t of e.ordered_api_categories)for(let s of e.api_dict_by_category[t])e.api_list.push(s.name);CodeMirror.commands.autocomplete=function(t){t.showHint({hint:CodeMirror.hint.anyword,api_list:e.api_list,extra_autocomplete_list:e.extra_autocomplete_list})}}))}create_keymap(){let e=this;CodeMirror.keyMap.default.Esc=function(){e.clearSelections()};let t=CodeMirror.keyMap.default.hasOwnProperty("Cmd-S");this.mousetrap.bind(["escape"],(function(t){e.clearSelections(),t.preventDefault()})),t?(CodeMirror.keyMap.default["Cmd-S"]=function(){e.props.saveMe()},this.mousetrap.bind(["command+l"],(function(e){e.preventDefault()})),this.mousetrap.bind(["command+f"],(function(t){e.searchCM(),t.preventDefault()}))):(CodeMirror.keyMap.default["Ctrl-S"]=function(){e.props.saveMe()},this.mousetrap.bind(["ctrl+l"],(function(e){e.preventDefault()})),this.mousetrap.bind(["ctrl+f"],(function(t){e.searchCM(),t.preventDefault()})))}render(){let e={height:this.props.code_container_height,width:"100%"};return React.createElement("div",{id:"code-container",style:e,ref:this.code_container_ref})}}n.propTypes={handleChange:PropTypes.func,code_content:PropTypes.string,sync_to_prop:PropTypes.bool,mode:PropTypes.string,saveMe:PropTypes.func,readOnly:PropTypes.bool,first_line_number:PropTypes.number,extraKeys:PropTypes.object,setCMObject:PropTypes.func,code_container_height:PropTypes.oneOfType([PropTypes.string,PropTypes.number])},n.defaultProps={first_line_number:1,code_container_height:"100%",sync_to_prop:!1,mode:"python",readOnly:!1,extraKeys:{},setCMObject:null}},function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return h})),s.d(t,"c",(function(){return p})),s.d(t,"d",(function(){return d}));var a=s(7),n=s(10),i=s(1),o=s(5),r=s(3),l=s(0);const c=17;class h extends o.a{initialize_socket_stuff(){this.socket.emit("join",{room:window.user_id}),this.socket.emit("join-main",{room:window.resource_viewer_id}),this.socket.on("handle-callback",l.a),this.socket.on("stop-spinner",stopSpinner),this.socket.on("start-spinner",startSpinner),this.socket.on("close-user-windows",e=>{e.originator!=window.resource_viewer_id&&window.close()}),this.socket.on("doFlash",(function(e){doFlash(e)}))}}function p(e,t){function s(s){const a={res_type:e,res_name:t,new_res_name:s};Object(l.b)("copy_from_repository",a,doFlashAlways)}$.getJSON($SCRIPT_ROOT+`get_resource_names/${e}`,(function(a){showModal(`Import ${e}`,`New ${e} Name`,s,t,a.resource_names)}))}function d(e,t){function s(s){const a={res_type:e,res_name:t,new_res_name:s};Object(l.b)("send_to_repository",a,doFlashAlways)}$.getJSON($SCRIPT_ROOT+`get_repository_resource_names/${e}`,(function(a){Object(i.b)(`Share ${e}`,`New ${e} Name`,s,t,a.resource_names)}))}class u extends React.Component{constructor(e){super(e),this.savedContent=e.the_content,this.savedTags=e.tags,this.savedNotes=e.notes,this.hp_ref=React.createRef();let t=this;this.mousetrap=new Mousetrap,this.mousetrap.bind(["command+s","ctrl+s"],(function(e){t.props.saveMe(),e.preventDefault()})),this.update_window_dimensions=this.update_window_dimensions.bind(this),this.state={mounted:!1,usable_width:window.innerWidth-2*c-30,usable_height:window.innerHeight-50}}componentDidMount(){window.addEventListener("resize",this.update_window_dimensions),this.setState({mounted:!0}),this.update_window_dimensions(),stopSpinner()}update_window_dimensions(){this.setState({usable_width:window.innerWidth-2*c-30,usable_height:window.innerHeight-50})}get_new_hp_height(e){return this.state.mounted?this.state.usable_height-$(e.current).offset().top:this.state.usable_height-45}render(){let e=React.createElement(React.Fragment,null,this.props.children),t=this.get_new_hp_height(this.hp_ref),s=React.createElement(n.a,{tags:this.props.tags,created:this.props.created,notes:this.props.notes,handleChange:this.props.handleStateChange,res_type:this.props.res_type});return React.createElement(React.Fragment,null,React.createElement(a.b,{button_groups:this.props.button_groups,resource_name:this.props.resource_name,res_type:this.props.res_type}),React.createElement("div",{ref:this.hp_ref}),React.createElement(r.a,{left_pane:e,right_pane:s,available_height:t,available_width:this.state.usable_width}))}}u.propTypes={resource_name:PropTypes.string,res_type:PropTypes.string,button_groups:PropTypes.array,created:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,handleStateChange:PropTypes.func,meta_outer:PropTypes.string,saveMe:PropTypes.func,children:PropTypes.element}},function(e,t,s){"use strict";var a=s(4),n=s(0);function i(e){return React.createElement("button",{type:"button",className:e.classNames.selectedTag,title:"Click to remove tag",onClick:e.onDelete},React.createElement("span",{className:e.classNames.selectedTagName},e.tag.name))}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e};const r={position:"absolute",width:0,height:0,visibility:"hidden",overflow:"scroll",whiteSpace:"pre"},l=["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing"];class c extends React.Component{constructor(e){super(e),this.state={inputWidth:null}}componentDidMount(){this.props.autoresize&&(this.copyInputStyles(),this.updateInputWidth()),this.props.autofocus&&this.input.focus()}componentDidUpdate(){this.updateInputWidth()}copyInputStyles(){const e=window.getComputedStyle(this.input);l.forEach(t=>{this.sizer.style[t]=e[t]})}updateInputWidth(){let e;this.props.autoresize&&(e=Math.ceil(this.sizer.scrollWidth)+2),e!==this.state.inputWidth&&this.setState({inputWidth:e})}render(){const{inputAttributes:e,inputEventHandlers:t,query:s,placeholder:a,expandable:n,listboxId:i,selectedIndex:l}=this.props;return React.createElement("div",{className:this.props.classNames.searchInput},React.createElement("input",o({},e,t,{ref:e=>{this.input=e},value:s,placeholder:a,role:"combobox","aria-autocomplete":"list","aria-label":a,"aria-owns":i,"aria-activedescendant":l>-1?`${i}-${l}`:null,"aria-expanded":n,style:{width:this.state.inputWidth}})),React.createElement("div",{ref:e=>{this.sizer=e},style:r},s||a))}}function h(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}function p(e,t){if(t){const s=RegExp(h(t),"gi");e=e.replace(s,"<mark>$&</mark>")}return{__html:e}}function d(e,t,s,a){if(!a){const t=new RegExp(`(?:^|\\s)${h(e)}`,"i");a=e=>t.test(e.name)}return t.filter(t=>a(t,e)).slice(0,s)}class u extends React.Component{constructor(e){super(e),this.state={options:d(this.props.query,this.props.suggestions,this.props.maxSuggestionsLength,this.props.suggestionsFilter)}}componentWillReceiveProps(e){this.setState({options:d(e.query,e.suggestions,e.maxSuggestionsLength,e.suggestionsFilter)})}handleMouseDown(e,t){t.preventDefault(),this.props.addTag(e)}render(){if(!this.props.expandable||!this.state.options.length)return null;const e=this.state.options.map((e,t)=>{const s=`${this.props.listboxId}-${t}`,a=[];return this.props.selectedIndex===t&&a.push(this.props.classNames.suggestionActive),e.disabled&&a.push(this.props.classNames.suggestionDisabled),React.createElement("li",{id:s,key:s,role:"option",className:a.join(" "),"aria-disabled":!0===e.disabled,onMouseDown:this.handleMouseDown.bind(this,e)},React.createElement("span",{dangerouslySetInnerHTML:p(e.name,this.props.query)}))});return React.createElement("div",{className:this.props.classNames.suggestions},React.createElement("ul",{role:"listbox",id:this.props.listboxId},e))}}var _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e};const m={ENTER:13,TAB:9,BACKSPACE:8,UP_ARROW:38,DOWN_ARROW:40},g={root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled"};class f extends React.Component{constructor(e){super(e),this.state={query:"",focused:!1,expandable:!1,selectedIndex:-1,classNames:Object.assign({},g,this.props.classNames)},this.inputEventHandlers={onChange:()=>{},onBlur:this.handleBlur.bind(this),onFocus:this.handleFocus.bind(this),onInput:this.handleInput.bind(this),onKeyDown:this.handleKeyDown.bind(this)}}componentWillReceiveProps(e){this.setState({classNames:Object.assign({},g,e.classNames)})}handleInput(e){const t=e.target.value;this.props.handleInputChange&&this.props.handleInputChange(t),this.setState({query:t})}handleKeyDown(e){const{query:t,selectedIndex:s}=this.state,{delimiters:a,delimiterChars:n}=this.props;(a.indexOf(e.keyCode)>-1||n.indexOf(e.key)>-1)&&((t||s>-1)&&e.preventDefault(),this.handleDelimiter()),e.keyCode===m.BACKSPACE&&0===t.length&&this.props.allowBackspace&&this.deleteTag(this.props.tags.length-1),e.keyCode===m.UP_ARROW&&(e.preventDefault(),s<=0?this.setState({selectedIndex:this.suggestions.state.options.length-1}):this.setState({selectedIndex:s-1})),e.keyCode===m.DOWN_ARROW&&(e.preventDefault(),this.setState({selectedIndex:(s+1)%this.suggestions.state.options.length}))}handleDelimiter(){const{query:e,selectedIndex:t}=this.state;if(e.length>=this.props.minQueryLength){const s=this.suggestions.state.options.findIndex(t=>0===t.name.search(new RegExp(`^${e}$`,"i"))),a=-1===t?s:t;a>-1?this.addTag(this.suggestions.state.options[a]):this.props.allowNew&&this.addTag({name:e})}}handleClick(e){document.activeElement!==e.target&&this.input.input.focus()}handleBlur(){this.setState({focused:!1,selectedIndex:-1}),this.props.handleBlur&&this.props.handleBlur(),this.props.addOnBlur&&this.handleDelimiter()}handleFocus(){this.setState({focused:!0}),this.props.handleFocus&&this.props.handleFocus()}addTag(e){e.disabled||("function"!=typeof this.props.handleValidate||this.props.handleValidate(e))&&(this.props.handleAddition(e),this.setState({query:"",selectedIndex:-1}))}deleteTag(e){this.props.handleDelete(e),this.props.clearInputOnDelete&&""!==this.state.query&&this.setState({query:""})}render(){const e=this.props.tagComponent||i,t=this.props.tags.map((t,s)=>React.createElement(e,{key:s,tag:t,classNames:this.state.classNames,onDelete:this.deleteTag.bind(this,s)})),s=this.state.focused&&this.state.query.length>=this.props.minQueryLength,a=[this.state.classNames.root];return this.state.focused&&a.push(this.state.classNames.rootFocused),React.createElement("div",{className:a.join(" "),onClick:this.handleClick.bind(this)},React.createElement("div",{className:this.state.classNames.selected,"aria-live":"polite","aria-relevant":"additions removals"},t),React.createElement("div",{className:this.state.classNames.search},React.createElement(c,_({},this.state,{inputAttributes:this.props.inputAttributes,inputEventHandlers:this.inputEventHandlers,ref:e=>{this.input=e},listboxId:"ReactTags-listbox",autofocus:this.props.autofocus,autoresize:this.props.autoresize,expandable:s,placeholder:this.props.placeholder})),React.createElement(u,_({},this.state,{ref:e=>{this.suggestions=e},listboxId:"ReactTags-listbox",expandable:s,suggestions:this.props.suggestions,suggestionsFilter:this.props.suggestionsFilter,addTag:this.addTag.bind(this),maxSuggestionsLength:this.props.maxSuggestionsLength}))))}}f.defaultProps={tags:[],placeholder:"Add new tag",suggestions:[],suggestionsFilter:null,autofocus:!0,autoresize:!0,delimiters:[m.TAB,m.ENTER],delimiterChars:[],minQueryLength:2,maxSuggestionsLength:6,allowNew:!1,allowBackspace:!0,tagComponent:null,inputAttributes:{},addOnBlur:!1,clearInputOnDelete:!0},f.propTypes={tags:PropTypes.arrayOf(PropTypes.object),placeholder:PropTypes.string,suggestions:PropTypes.arrayOf(PropTypes.object),suggestionsFilter:PropTypes.func,autofocus:PropTypes.bool,autoresize:PropTypes.bool,delimiters:PropTypes.arrayOf(PropTypes.number),delimiterChars:PropTypes.arrayOf(PropTypes.string),handleDelete:PropTypes.func.isRequired,handleAddition:PropTypes.func.isRequired,handleInputChange:PropTypes.func,handleFocus:PropTypes.func,handleBlur:PropTypes.func,handleValidate:PropTypes.func,minQueryLength:PropTypes.number,maxSuggestionsLength:PropTypes.number,classNames:PropTypes.object,allowNew:PropTypes.bool,allowBackspace:PropTypes.bool,tagComponent:PropTypes.oneOfType([PropTypes.func,PropTypes.element]),inputAttributes:PropTypes.object,addOnBlur:PropTypes.bool,clearInputOnDelete:PropTypes.bool},s.d(t,"a",(function(){return C}));var y=window.ReactBootstrap;class b extends React.Component{constructor(e){super(e),doBinding(this),this.state={suggestions:[]}}componentDidMount(){let e=this,t={res_type:this.props.res_type,is_repository:!1};Object(n.c)("get_tag_list",t).then((function(t){let s=e._fillOutTags(t.tag_list);e.setState({suggestions:s})}))}_fillOutTags(e){return e.map((e,t)=>({id:t,name:e}))}_extractTags(e){return e.map(e=>e.name)}_handleDelete(e){let t=[...this.props.tags];t.splice(e,1),this.props.handleChange(t)}_handleAddition(e){let t=[...this.props.tags];t.push(e.name),this.props.handleChange(t)}render(){let e=this._fillOutTags(this.props.tags);return React.createElement(f,{tags:e,allowNew:!0,suggestions:this.state.suggestions,handleDelete:this._handleDelete,handleAddition:this._handleAddition})}}b.proptypes={tags:PropTypes.array,handleChange:PropTypes.func,res_type:PropTypes.string};class R extends React.Component{constructor(e){super(e),this.tags_field_ref=React.createRef(),this.tag_containing_div=React.createRef(),this.last_tags_list=[],this.setting_tags=!1,this.state={has_focus:!1},this.all_tags=[],doBinding(this)}get_tags_field(){return $(this.tags_field_ref.current)}_handleMyChange(e,t,s){this.setting_tags||this.props.handleChange(e,t,s)}create_tag_editor(e){let t=this,s={res_type:this.props.res_type,is_repository:!1};Object(n.c)("get_tag_list",s).then((function(s){t.all_tags=s.tag_list,t.get_tags_field().tagEditor({initialTags:e,forceLowercase:!0,autocomplete:{delay:0,position:{collision:"flip"},source:t.all_tags},onChange:t._handleMyChange,placeholder:"Tags..."})})).catch(doFlash)}componentDidMount(){this.last_tags_list=this.props.tags,this.create_tag_editor(this.props.tags)}componentDidUpdate(){this.props.tags!=this.last_tags_list&&(this.last_tags_list=this.props.tags,this.set_tag_list(this.props.tags))}get has_focus(){return this.tag_containing_div.current.contains(document.activeElement)}get_tags(){return this.get_tags_field().tagEditor("getTags")[0].tags}add_tags(e){let t=this.has_focus;this.setting_tags=!0;for(let s of e)this.get_tags_field().tagEditor("addTag",s,!t);this.setting_tags=!1}remove_all_tags(){let e=this.has_focus,t=this.get_tags();this.setting_tags=!0;for(let s of t)this.get_tags_field().tagEditor("removeTag",s,!e);this.setting_tags=!1}set_tag_list(e){null!=this.get_tags()&&(this.remove_all_tags(),this.add_tags(e))}render(){let e={pointerEvents:this.context.readOnly?"none":"all"};return React.createElement("div",{ref:this.tag_containing_div,style:e},React.createElement(y.Form.Control,{as:"textarea",ref:this.tags_field_ref,className:"metadata-field",rows:"1"}))}}R.contextType=a.a,R.propTypes={tags:PropTypes.array,handleChange:PropTypes.func,res_type:PropTypes.string};class w extends React.Component{constructor(e){super(e),this.state={md_height:500,show_markdown:!this.hasOnlyWhitespace&&this.props.show_markdown_initial},doBinding(this),this.notes_ref=React.createRef(),this.md_ref=React.createRef(),this.converter=new showdown.Converter,this.awaiting_focus=!1}getNotesField(){return $(this.notes_ref.current)}get hasOnlyWhitespace(){return!this.props.notes.trim().length}getMarkdownField(){return $(this.md_ref.current)}componentDidUpdate(){this.awaiting_focus?(this.focusNotes(),this.awaiting_focus=!1):this.state.show_markdown||this.notes_ref.current==document.activeElement||this._showMarkdown()}focusNotes(){this.getNotesField().focus()}_hideMarkdown(){this.awaiting_focus=!0,this.setState({show_markdown:!1})}_handleMyBlur(){this._showMarkdown(),null!=this.props.handleBlur&&this.props.handleBlur()}_showMarkdown(){this.hasOnlyWhitespace||this.setState({show_markdown:!0})}render(){let e=!this.hasOnlyWhitespace&&this.state.show_markdown,t={display:e?"none":"block",fontSize:14},s={display:e?"block":"none",maxHeight:this.state.md_height,fontSize:14};var a;e&&(a=this.converter.makeHtml(this.props.notes));let n={__html:a};return React.createElement(y.Form.Group,null,React.createElement(y.Form.Control,{as:"textarea",className:"metadata-field notes-field",ref:this.notes_ref,rows:"10",placeholder:"notes",style:t,onBlur:this._handleMyBlur,onChange:this.props.handleChange,readOnly:this.context.readOnly,value:this.props.notes}),React.createElement("div",{ref:this.md_ref,style:s,onClick:this._hideMarkdown,className:"notes-field-markdown-output",dangerouslySetInnerHTML:n}))}}w.contextType=a.a,w.propTypes={notes:PropTypes.string,handleChange:PropTypes.func,show_markdown_initial:PropTypes.bool,handleBlur:PropTypes.func},w.defaultProops={handleBlur:null};class C extends React.Component{constructor(e){super(e),doBinding(this)}_handleNotesChange(e){this.props.handleChange({notes:e.target.value})}_handleTagsChange(e,t,s){this.props.handleChange({tags:s})}_handleTagsChangeNative(e){this.props.handleChange({tags:e})}_handleCategoryChange(e){this.props.handleChange({category:e.target.value})}render(){let e,t={fontSize:14};if(null!=this.props.additional_metadata){e=[];for(let s in this.props.additional_metadata){let a=this.props.additional_metadata[s];if(Array.isArray(a))a=a.join(", ");else if("collection_name"==s){let e=/\.\w*$/.exec(a);null!=e&&(a=e[0].slice(1))}e.push(React.createElement("div",{style:t,key:s},React.createElement("span",{className:"text-primary"},s+": "),a))}}return React.createElement("div",{className:"combined-metadata",style:this.props.outer_style},null!=this.props.name&&React.createElement("h4",null,this.props.name),React.createElement(y.Form,null,React.createElement(y.Form.Group,null,React.createElement(y.Form.Label,null,React.createElement("span",{className:"text-primary"},"Tags")),React.createElement(b,{tags:this.props.tags,handleChange:this._handleTagsChangeNative,res_type:this.props.res_type})),null!=this.props.category&&React.createElement(y.Form.Group,null,React.createElement(y.Form.Label,null,React.createElement("span",{className:"text-primary"},"Category")),React.createElement(y.Form.Control,{as:"input",onChange:this._handleCategoryChange,value:this.props.category})),React.createElement(y.Form.Group,null,React.createElement(y.Form.Label,null,React.createElement("span",{className:"text-primary"},"Notes")),React.createElement(w,{notes:this.props.notes,handleChange:this._handleNotesChange,show_markdown_initial:!0,handleBlur:this.props.handleNotesBlur})),React.createElement("div",{style:t},React.createElement("span",{className:"text-primary"},"Created: "),this.props.created),null!=this.props.updated&&React.createElement("div",{style:t},React.createElement("span",{className:"text-primary"},"Updated: "),this.props.updated),null!=this.props.additional_metadata&&e))}}C.propTypes={outer_style:PropTypes.object,res_type:PropTypes.string,name:PropTypes.string,created:PropTypes.string,updated:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,category:PropTypes.string,handleChange:PropTypes.func,handleNotesBlur:PropTypes.func,additional_metadata:PropTypes.object},C.defaultProps={outer_style:{marginLeft:20},handleNotesBlur:null,category:null,name:null,updated:null,additional_metadata:null}},,,,,,,,,,,,,,,,function(e,t,s){"use strict";s.r(t);var a=s(5),n=s(7),i=s(9),o=s(8),r=s(10),l=s(2),c=window.ReactBootstrap;class h extends React.Component{constructor(e){super(e),this.option_types=["text","int","boolean","textarea","codearea","column_select","document_select","list_select","collection_select","palette_select","pipe_select","custom_list","function_select","class_select","tile_select"],this.taggable_types=["class_select","function_select","pipe_select","list_select","collection_select"],this.state={name:"",type:"text",default:"",special_list:"",tags:""},this.handleNameChange=this.handleNameChange.bind(this),this.handleDefaultChange=this.handleDefaultChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleTypeChange=this.handleTypeChange.bind(this),this.handleSpecialListChange=this.handleSpecialListChange.bind(this)}handleNameChange(e){this.setState({name:e.target.value})}handleDefaultChange(e){this.setState({default:e.target.value})}handleTagChange(e){this.setState({tags:e.target.value})}handleSpecialListChange(e){this.setState({special_list:e.target.value})}handleTypeChange(e){this.setState({type:e})}handleSubmit(){this.props.handleCreate(this.state)}render(){return React.createElement(c.Form,null,React.createElement(c.Form.Row,null,React.createElement(l.b,{label:"Name",onChange:this.handleNameChange,the_value:this.state.name}),React.createElement(l.c,{label:"Type",option_list:this.option_types,onChange:this.handleTypeChange,the_value:this.state.type}),React.createElement(l.b,{label:"Default",onChange:this.handleDefaultChange,the_value:this.state.default_value}),React.createElement(l.b,{label:"Special List",onChange:this.handleSpecialListChange,the_value:this.state.special_list,show:"custom_list"==this.state.type}),React.createElement(l.b,{label:"Tag",onChange:this.handleTagChange,the_value:this.state.tag,show:this.taggable_types.includes(this.state.type)})),React.createElement(c.Button,{variant:"outline-secondary",type:"button",onClick:this.handleSubmit},"Create"))}}h.propTypes={handleCreate:PropTypes.func};class p extends React.Component{constructor(e){super(e),this.state={active_row:0},this.handleActiveRowChange=this.handleActiveRowChange.bind(this),this.handleCreate=this.handleCreate.bind(this)}delete_option(){let e=this.props.data_list;e.splice(this.state.active_row,1),this.props.handleChange(e)}send_doc_text(){let e="\n\noptions: \n\n";for(let t of this.props.data_list)e+=` * \`${t.name}\` (${t.type}): \n`;this.props.handleNotesAppend(e)}handleCreate(e){let t=this.props.data_list;t.push(e),this.props.handleChange(t)}handleActiveRowChange(e){this.setState({active_row:e})}get button_groups(){let e=[[{name_text:"delete",icon_name:"trash",click_handler:this.delete_option},{name_text:"to meta",icon_name:"list-alt",click_handler:this.send_doc_text}]];for(let t of e)for(let e of t)e.click_handler=e.click_handler.bind(this);return e}render(){return this.state.active_row>=this.props.data_list.length&&(this.state.active_row=this.props.data_list.length-1),React.createElement("div",{id:"options-pane",className:"d-flex flex-column",style:{marginTop:25,marginLeft:25,marginRight:25}},React.createElement("div",{className:"d-flex flex-row mb-2"},React.createElement(n.c,{button_groups:this.button_groups})),React.createElement(l.d,{columns:["name","type","default","special_list","tags"],data_array:this.props.data_list,active_row:this.state.active_row,handleActiveRowChange:this.handleActiveRowChange,handleChange:this.props.handleChange,content_editable:!0}),React.createElement(h,{handleCreate:this.handleCreate}))}}p.propTypes={data_list:PropTypes.array,handleChange:PropTypes.func,handleNotesAppend:PropTypes.func};class d extends React.Component{constructor(e){super(e),this.state={name:"",tags:""},this.handleNameChange=this.handleNameChange.bind(this),this.handleTagChange=this.handleTagChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleNameChange(e){this.setState({name:e.target.value})}handleTagChange(e){this.setState({tags:e.target.value})}handleSubmit(){this.props.handleCreate(this.state)}render(){return React.createElement(c.Form,null,React.createElement(c.Form.Row,null,React.createElement(l.b,{label:"Name",onChange:this.handleNameChange,the_value:this.state.name}),React.createElement(l.b,{label:"Tag",onChange:this.handleTagChange,the_value:this.state.tag})),React.createElement(c.Button,{variant:"outline-secondary",type:"button",onClick:this.handleSubmit},"Create"))}}d.propTypes={handleCreate:PropTypes.func};class u extends React.Component{constructor(e){super(e),this.state={active_row:0},this.handleActiveRowChange=this.handleActiveRowChange.bind(this),this.handleCreate=this.handleCreate.bind(this)}delete_export(){let e=this.props.data_list;e.splice(this.state.active_row,1),this.props.handleChange(e)}send_doc_text(){let e="\n\nexports: \n\n";for(let t of this.props.data_list)e+=` * \`${t.name}\` : \n`;this.props.handleNotesAppend(e)}handleCreate(e){let t=this.props.data_list;t.push(e),this.props.handleChange(t)}handleActiveRowChange(e){this.setState({active_row:e})}get button_groups(){let e=[[{name_text:"delete",icon_name:"trash",click_handler:this.delete_export},{name_text:"to meta",icon_name:"list-alt",click_handler:this.send_doc_text}]];for(let t of e)for(let e of t)e.click_handler=e.click_handler.bind(this);return e}render(){return this.state.active_row>=this.props.data_list.length&&(this.state.active_row=this.props.data_list.length-1),React.createElement("div",{id:"exports-pane",className:"d-flex flex-column",style:{marginTop:25,marginLeft:25,marginRight:25}},React.createElement("div",{className:"d-flex flex-row mb-2"},React.createElement(n.c,{button_groups:this.button_groups})),React.createElement(l.d,{columns:["name","tags"],data_array:this.props.data_list,active_row:this.state.active_row,handleActiveRowChange:this.handleActiveRowChange,handleChange:this.props.handleChange,content_editable:!0}),React.createElement(d,{handleCreate:this.handleCreate}))}}u.propTypes={data_list:PropTypes.array,handleChange:PropTypes.func,handleNotesAppend:PropTypes.func};var _=s(3),m=s(6),g=s(0),f=window.ReactBootstrap;const y=17;var b=setInterval((function(){Object(g.b)("register_heartbeat",{main_id:window.main_id},(function(){}))}),1e4);class R extends a.a{initialize_socket_stuff(){this.socket.emit("join",{room:user_id}),this.socket.emit("join-main",{room:module_viewer_id}),this.socket.on("stop-spinner",stopSpinner),this.socket.on("start-spinner",startSpinner),this.socket.on("handle-callback",g.a),this.socket.on("close-user-windows",e=>{e.originator!=module_viewer_id&&window.close()}),this.socket.on("stop-heartbeat",(function(e){clearInterval(b)})),this.socket.on("doFlash",(function(e){doFlash(e)}))}}function w(e){let t=document.querySelector("#creator-root"),s=e.the_content,a={res_type:"tile",res_name:window.module_name,is_repository:!1};Object(g.c)("grab_metadata",a).then((function(e){let a=""==e.tags?[]:e.tags.split(" ");ReactDOM.render(React.createElement(T,{tile_name:window.module_name,is_mpl:s.is_mpl,is_d3:s.is_d3,render_content_code:s.render_content_code,render_content_line_number:s.render_content_line_number,extra_methods_line_number:s.extra_methods_line_number,draw_plot_line_number:s.draw_plot_line_number,category:s.category,extra_functions:s.extra_functions,draw_plot_code:s.draw_plot_code,jscript_code:s.jscript_code,tags:a,notes:e.notes,option_list:s.option_dict,export_list:s.export_list,created:e.datestring}),t),clearStatusMessage(),stopSpinner()})).catch((function(e){doFlash(e),clearStatusMessage(),stopSpinner()}))}function C(e){return React.createElement("div",{style:{marginTop:20,paddingRight:20,width:"100%"},className:"d-flex flex-row justify-content-between"},React.createElement(n.a,{resource_name:e.tile_name,res_type:e.res_type,handleRename:e.handleRename}),React.createElement("div",null,React.createElement(n.c,{button_groups:e.button_groups})))}class T extends React.Component{constructor(e){super(e);let t=window.innerHeight-45-y,s=window.innerWidth-2*y-30;this.left_div_ref=React.createRef(),this.right_div_ref=React.createRef(),this.tc_span_ref=React.createRef(),this.rc_span_ref=React.createRef(),this.vp_ref=React.createRef(),this.hp_ref=React.createRef(),this.draw_plot_bounding_ref=React.createRef(),this.state={tile_name:this.props.tile_name,render_content_code:this.props.render_content_code,draw_plot_code:this.props.draw_plot_code,jscript_code:this.props.jscript_code,extra_functions:this.props.extra_functions,render_content_line_number:this.props.render_content_line_number,draw_plot_line_number:this.props.draw_plot_line_number,extra_methods_line_number:this.props.extra_methods_line_number,tags:this.props.tags,notes:this.props.notes,option_list:this.props.option_list,export_list:this.props.export_list,category:this.props.category,usable_width:s,usable_height:t,top_pane_height:this.props.is_mpl||this.props.is_d3?t/2-25:null,bottom_pane_height:this.props.is_mpl||this.props.is_d3?t/2-25:null,left_pane_width:s/2-25,methodsTabRefreshRequired:!0},this.saved_state_vars=["tile_name","render_content_code","draw_plot_code","jscript_code","extra_functions","tags","notes","option_list","export_list","category"],this.saved_state={},this.update_saved_state(),this.handleRename=this.handleRename.bind(this),this.handleStateChange=this.handleStateChange.bind(this),this.handleRenderContentChange=this.handleRenderContentChange.bind(this),this.handleTopCodeChange=this.handleTopCodeChange.bind(this),this.update_window_dimensions=this.update_window_dimensions.bind(this),this.handleOptionsChange=this.handleOptionsChange.bind(this),this.handleExportsChange=this.handleExportsChange.bind(this),this.handleMethodsChange=this.handleMethodsChange.bind(this),this.handleTabSelect=this.handleTabSelect.bind(this),this.handleLeftPaneResize=this.handleLeftPaneResize.bind(this),this.handleTopPaneResize=this.handleTopPaneResize.bind(this)}update_saved_state(){for(let e of this.saved_state_vars)this.saved_state[e]=this.state[e]}dirty(){for(let e of this.saved_state_vars)if(this.state[e]!=this.saved_state[e])return!0;return!1}get button_groups(){let e=[[{name_text:"Save",icon_name:"save",click_handler:this.saveMe},{name_text:"Mark",icon_name:"map-marker-alt",click_handler:this.saveAndCheckpoint},{name_text:"Save as...",icon_name:"save",click_handler:this.saveModuleAs},{name_text:"Load",icon_name:"arrow-from-bottom",click_handler:this.loadModule},{name_text:"Share",icon_name:"share",click_handler:()=>{Object(i.d)("tile",this.props.tile_name)}}],[{name_text:"History",icon_name:"history",click_handler:this.showHistoryViewer},{name_text:"Compare",icon_name:"code-branch",click_handler:this.showTileDiffer}]];for(let t of e)for(let e of t)e.click_handler=e.click_handler.bind(this);return e}showHistoryViewer(){window.open(`${$SCRIPT_ROOT}/show_history_viewer/${this.props.tile_name}`)}showTileDiffer(){window.open(`${$SCRIPT_ROOT}/show_tile_differ/${this.props.tile_name}`)}loadModule(){let e=this;function t(t){return t.success&&(e.update_saved_state(),t.timeout=2e3),doFlashStopSpinner(t),!1}startSpinner(),this.doSavePromise().then((function(){statusMessageText("Loading Module"),Object(g.f)("host","load_tile_module_task",{tile_module_name:e.state.tile_name,user_id:user_id},t)})).catch(doFlashStopSpinner)}saveModuleAs(){return doFlash({message:"not implemented yet"}),!1}saveMe(){return startSpinner(),statusMessageText("Saving Module"),this.doSavePromise().then(doFlashStopSpinner).catch(doFlashStopSpinner),!1}saveAndCheckpoint(){startSpinner();let e=this;return this.doSavePromise().then((function(){statusMessage("Checkpointing"),e.doCheckpointPromise().then(doFlashStopSpinner).catch(doFlashStopSpinner)})).catch(doFlashStopSpinner),!1}get_tags_string(){let e=this.state.tags,t="";for(let s of e)t=t+s+" ";return t.trim()}doSavePromise(){let e=this;return new Promise((function(t,s){let a={module_name:e.state.tile_name,category:0==e.state.category.length?"basic":e.state.category,tags:e.get_tags_string(),notes:e.state.notes,exports:e.state.export_list,options:e.state.option_list,extra_methods:e.state.extra_functions,render_content_body:e.state.render_content_code,is_mpl:e.props.is_mpl,is_d3:e.props.is_d3,draw_plot_body:e.state.draw_plot_code,jscript_body:e.state.jscript_code,last_saved:"creator"};Object(g.f)(module_viewer_id,"update_module",a,(function(a){a.success?(e.save_success(a),t(a)):s(a)}))}))}doCheckpointPromise(){let e=this;return new Promise((function(t,s){Object(g.b)("checkpoint_module",{module_name:e.state.tile_name},(function(e){e.success?t(e):s(e)}))}))}save_success(e){this.setState({render_content_line_number:e.render_content_line_number,extra_methods_line_number:e.extra_methods_line_number,draw_plot_line_number:e.draw_plot_line_number}),this.update_saved_state()}update_window_dimensions(){this.setState({usable_width:window.innerWidth-2*y-30,usable_height:window.innerHeight-50})}componentDidMount(){this.setState({mounted:!0}),document.title=this.state.tile_name,this.update_window_dimensions(),window.addEventListener("resize",this.update_window_dimensions),stopSpinner()}handleTabSelect(){this.setState({methodsTabRefreshRequired:!1})}handleNotesAppend(e){this.setState({notes:this.state.notes+e})}handleStateChange(e){this.setState(e)}handleOptionsChange(e){this.setState({option_list:e})}handleExportsChange(e){this.setState({export_list:e})}handleMethodsChange(e){this.setState({extra_functions:e})}get_height_minus_top_offset(e){return this.state.mounted?this.state.usable_height-$(e.current).offset().top:this.state.usable_height-50}get_new_tc_height(){return this.state.mounted?this.state.top_pane_height-this.tc_span_ref.current.offsetHeight:this.state.top_pane_height-50}get_new_rc_height(e){return this.state.mounted?e-this.rc_span_ref.current.offsetHeight:e-50}handleTopPaneResize(e,t,s){this.setState({top_pane_height:e,bottom_pane_height:t})}handleLeftPaneResize(e,t,s){this.setState({left_pane_width:e})}handleTopCodeChange(e){this.props.is_mpl?this.setState({draw_plot_code:e}):this.setState({jscript_code:e})}handleRenderContentChange(e){this.setState({render_content_code:e})}handleRename(e){}render(){let e,t,s=this.get_height_minus_top_offset(this.hp_ref),a=this.get_height_minus_top_offset(this.vp_ref),n={width:this.state.left_pane_width-10};if(this.props.is_mpl||this.props.is_d3){let t=this.get_new_tc_height(),s=this.props.is_mpl?"python":"javascript",a=this.props.is_mpl?this.state.draw_plot_code:this.state.jscript_code,i=this.props.is_mpl?this.state.draw_plot_line_number:1,r=this.props.is_mpl?"draw_plot":"(selector, w, h, arg_dict) =>";e=React.createElement("div",{key:"dpcode",style:n,className:"d-flex flex-column align-items-baseline code-holder"},React.createElement("span",{ref:this.tc_span_ref},r),React.createElement(o.a,{code_content:a,mode:s,handleChange:this.handleTopCodeChange,saveMe:this.saveAndCheckpoint,readOnly:!1,first_line_number:i,code_container_height:t}))}t=this.props.is_mpl||this.props.is_d3?this.get_new_rc_height(this.state.bottom_pane_height):this.get_new_rc_height(a);let i,l=React.createElement("div",{key:"rccode",id:"rccode",style:n,className:"d-flex flex-column align-items-baseline code-holder"},React.createElement("span",{ref:this.rc_span_ref},"render_content"),React.createElement(o.a,{code_content:this.state.render_content_code,handleChange:this.handleRenderContentChange,saveMe:this.saveAndCheckpoint,readOnly:!1,first_line_number:this.state.render_content_line_number,code_container_height:t}));i=this.props.is_mpl||this.props.is_d3?React.createElement(React.Fragment,null,React.createElement(C,{tile_name:this.state.tile_name,res_type:"tile",handleRename:this.handleRename,button_groups:this.button_groups,key:"toolbar"}),React.createElement("div",{ref:this.vp_ref}),React.createElement(_.b,{top_pane:e,bottom_pane:l,available_height:a,available_width:this.state.left_pane_width,handleSplitUpdate:this.handleTopPaneResize,id:"creator-left"})):React.createElement(React.Fragment,null,React.createElement(C,{tile_name:this.state.tile_name,res_type:"tile",handleRename:this.handleRename,button_groups:this.button_groups,key:"toolbar"}),React.createElement("div",{ref:this.vp_ref},l));let c=React.createElement(React.Fragment,null,React.createElement("div",{id:"creator-resources",className:"d-block mt-2"},React.createElement(f.Tabs,{id:"resource_tabs",onSelect:this.handleTabSelect},React.createElement(f.Tab,{eventKey:"metadata",title:"metadata"},React.createElement(r.a,{tags:this.state.tags,notes:this.state.notes,created:this.props.created,category:this.state.category,res_type:"tile",handleChange:this.handleStateChange})),React.createElement(f.Tab,{eventKey:"options",title:"options"},React.createElement(p,{data_list:this.state.option_list,handleChange:this.handleOptionsChange,handleNotesAppend:this.handleNotesAppend})),React.createElement(f.Tab,{eventKey:"exports",title:"exports"},React.createElement(u,{data_list:this.state.export_list,handleChange:this.handleExportsChange,handleNotesAppend:this.handleNotesAppend})),React.createElement(f.Tab,{eventKey:"methods",title:"methods"},React.createElement(o.a,{handleChange:this.handleMethodsChange,code_content:this.state.extra_functions,save_me:this.saveAndCheckpoint,readOnly:!1,first_line_number:this.state.extra_methods_line_number,refresh_required:this.methodsTabRefreshRequired})))));return React.createElement(React.Fragment,null,React.createElement("div",{ref:this.hp_ref}),React.createElement(_.a,{left_pane:i,right_pane:c,available_height:s,available_width:this.state.usable_width,handleSplitUpdate:this.handleLeftPaneResize}))}}T.propTypes={tile_name:PropTypes.string,is_mpl:PropTypes.bool,render_content_code:PropTypes.string,render_content_line_number:PropTypes.number,extra_methods_line_number:PropTypes.number,category:PropTypes.string,extra_functions:PropTypes.string,draw_plot_code:PropTypes.string,jscript_code:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,option_list:PropTypes.array,export_list:PropTypes.array,created:PropTypes.string},function(){Object(m.b)(),startSpinner(),statusMessageText("loading "+window.module_name);var e=new R("main",5e3);e.socket.on("begin-post-load",(function(){let e={module_name:window.module_name,module_viewer_id:window.module_viewer_id,tile_collection_name:window.tile_collection_name,user_id:window.user_id,version_string:window.version_string};Object(g.f)(window.module_viewer_id,"initialize_parser",e,w)})),e.socket.emit("ready-to-begin",{room:window.main_id})}()}]);