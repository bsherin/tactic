!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=23)}([function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"f",(function(){return l})),s.d(t,"g",(function(){return p})),s.d(t,"e",(function(){return c}));let a={};function r(e){let t=e.callback_id,s=a[t];delete a[t],s(e.response_data)}function n(e,t,s){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:s})}function i(e,t){return new Promise((function(s,a){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:e=>{e.success&&s(e),a(e)}})}))}function o(e,t){return new Promise((function(s,a){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,type:"POST",data:t,contentType:!1,processData:!1,success:e=>{e.success&&s(e),a(e)}})}))}function l(e,t,s,r){const n={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,expiration:null};if(void 0!==r&&null!=r){const e=guid();a[e]=r,n.callback_id=e,n.callback_type="callback_no_context"}else n.callback_id=null,n.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(n),dataType:"json"})}function c(e,t,s){const a={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,callback_id:null,callback_type:"no_callback",expiration:null};$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!1,data:JSON.stringify(a),dataType:"json"})}function p(e,t,s,r){const n={source:"client",dest:e,task_type:t,task_data:s,response_data:null,expiration:null};if(void 0!==r){const e=guid();a[e]=r,n.callback_id=e,n.callback_type="callback_no_context"}else n.callback_id=null,n.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(n),dataType:"json"})}},function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"e",(function(){return p})),s.d(t,"a",(function(){return _}));var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},r=blueprint;const n=r.Toaster.create({className:"recipe-toaster",position:r.Position.TOP,autoFocus:!0}),i={"alert-success":"Success","alert-warning":"Warning","alert-info":null};function o(e){let t;t=e.hasOwnProperty("alert_type")?i[e.alert_type]:null,n.show({message:e.message,intent:t})}function l(e){o(e)}function c(e){stopSpinner(),clearStatusMessage(),o(e)}function p(e,t=null){return class extends React.Component{constructor(e){super(e),doBinding(this),this.tsocket=t,this.state={show_spinner:!1,status_message:null,spinner_size:this.props.spinner_size?this.props.spinner_size:25}}componentDidMount(){this.tsocket&&(this.tsocket.socket.on("stop-spinner",this._stopSpinner),this.tsocket.socket.on("start-spinner",this._startSpinner),this.tsocket.socket.on("show-status-msg",this._statusMessageFromData),this.tsocket.socket.on("clear-status-msg",this._clearStatusMessage))}_stopSpinner(){this.setState({show_spinner:!1})}_startSpinner(){this.setState({show_spinner:!0})}_clearStatusMessage(){this.setState({status_message:null})}_clearStatus(){this.setState({show_spinner:!1,status_message:null})}_statusMessage(e,t=null){this.setState({status_message:e},()=>{t&&setTimeout(self._clearStatusMessage,1e3*data.timeout)})}_statusMessageFromData(e){let t=this;this.setState({status_message:e.message},()=>{e.hasOwnProperty("timeout")&&null!=e.timeout&&setTimeout(t._clearStatusMessage,1e3*e.timeout)})}_setStatus(e){this.setState(e)}render(){return React.createElement(React.Fragment,null,React.createElement(e,a({},this.props,{startSpinner:this._startSpinner,stopSpinner:this._stopSpinner,clearStatus:this._clearStatus,clearStatusMessage:this._clearStatus,statusMessage:this._statusMessage,setStatus:this._setStatus})),React.createElement(_,this.state))}}}class _ extends React.Component{render(){return React.createElement("div",{className:"d-flex flex-row",style:{position:"absolute",bottom:10,marginLeft:10}},this.props.show_spinner&&React.createElement(r.Spinner,{size:20}),this.props.status_message&&React.createElement("div",{className:"d-flex flex-column justify-content-around",style:{marginLeft:10}},React.createElement("div",{id:"status-msg-area",className:"bp3-ui-text"},this.props.status_message)))}}_.propTypes={show_spinner:PropTypes.bool,status_message:PropTypes.string,spinner_size:PropTypes.number},_.defaultProps={show_spinner:!1,status_message:null,spinner_size:25}},function(e,t,s){"use strict";s.d(t,"d",(function(){return l})),s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return n}));var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e};const r=15,n=40,i=50,o=50;function l(){return{usable_width:window.innerWidth-2*r,usable_height:window.innerHeight-n-o,body_height:window.innerHeight-n}}const c=React.createContext({available_height:500,available_width:500});class p extends React.Component{constructor(e){super(e),this.dref=React.createRef(),this.state={mounted:!1,availableHeight:this.props.parentHeight-i,availableWidth:this.props.parentWidth-i,previousParentHeight:this.props.parentHeight,previousParentWidth:this.props.parentWidth,indent_left:0},doBinding(this)}componentDidMount(){this.setState({mounted:!0},this._updateDimensions)}_dimensionsHaveChanged(){return this.props.parentHeight!=this.state.previousParentHeight||this.props.parentWidth!=this.state.previousParentWidth}componentDidUpdate(){this._dimensionsHaveChanged()&&this.setState({previousParentHeight:this.props.parentHeight,previousParentWidth:this.props.parentWidth},this._updateDimensions)}_updateDimensions(){}render(){var e=this.props.component;let t=Object.assign({},this.props.div_style);if(this.props.am_outer&&(t.position="absolute",t.left=r),this.props.apply_dimensions_to_div&&(t=Object.assign({width:this.state.availableWidth,height:this.state.availableHeight},t)),this.props.component)return React.createElement(React.Fragment,null,React.createElement("div",{ref:this.dref,style:t,className:"sizer"},React.createElement(e,a({available_height:this.state.availableHeight,available_width:this.state.availableWidth},this.props))));{let e={available_height:this.state.availableHeight,available_width:this.state.availableWidth};return React.createElement(React.Fragment,null,React.createElement("div",{ref:this.dref,style:t,className:"sizer"}),React.createElement(c.Provider,{value:e},this.props.children))}}}p.propTypes={parentHeight:PropTypes.number,parentWidth:PropTypes.number,component:PropTypes.func,bottom_ref:PropTypes.object,right_ref:PropTypes.object,am_outer:PropTypes.bool,div_style:PropTypes.object,apply_dimensions_to_div:PropTypes.bool},p.defaultProps={bottom_ref:null,right_ref:null,component:null,am_outer:!1,div_style:{},apply_dimensions_to_div:!1}},function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return c})),s.d(t,"c",(function(){return o}));var a=blueprint;class r extends React.Component{constructor(e){super(e),doBinding(this);let t=this.props.default_value;for(var s=1;this.name_exists(t);)s+=1,t=this.props.default_value+String(s);this.state={show:!1,current_value:t,checkbox_states:{},warning_text:""}}_changeHandler(e){this.setState({current_value:e.target.value})}_checkbox_change_handler(e){e.target.checked;let t=Object.assign({},this.state.checkbox_states);t[e.target.id]=e.target.checked,this.setState({checkbox_states:t})}componentDidMount(){if(this.setState({show:!0}),null!=this.props.checkboxes&&0!=this.props.checkboxes.length){let e={};for(let t of this.props.checkboxes)e[t.id]=!1;this.setState({checkbox_states:e})}}name_exists(e){return this.props.existing_names.indexOf(e)>-1}_submitHandler(e){let t;""==this.state.current_value?(t="An empty name is not allowed here.",this.setState({warning_text:t})):this.name_exists(this.state.current_value)?(t="That name already exists",this.setState({warning_text:t})):(this.setState({show:!1}),this.props.handleSubmit(this.state.current_value,this.state.checkbox_states),this.props.handleClose())}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){let e=[];if(null!=this.props.checkboxes&&0!=this.props.checkboxes.length)for(let t of this.props.checkboxes){let s=React.createElement(a.Checkbox,{checked:this.state.checkbox_states[t.checkname],label:t.checktext,id:t.checkname,key:t.checkname,onChange:this._checkbox_change_handler});e.push(s)}return React.createElement(a.Dialog,{isOpen:this.state.show,title:this.props.title,onClose:this._cancelHandler,canEscapeKeyClose:!0},React.createElement("div",{className:a.Classes.DIALOG_BODY},React.createElement(a.FormGroup,{label:this.props.field_title,helperText:this.state.warning_text},React.createElement(a.InputGroup,{onChange:this._changeHandler,value:this.state.current_value})),0!=e.length&&e),React.createElement("div",{className:a.Classes.DIALOG_FOOTER},React.createElement("div",{className:a.Classes.DIALOG_FOOTER_ACTIONS},React.createElement(a.Button,{onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{intent:a.Intent.PRIMARY,onClick:this._submitHandler},"Submit"))))}}function n(e,t,s,a,n,i=null){void 0===n&&(n=[]);let o=document.querySelector("#modal-area");ReactDOM.render(React.createElement(r,{handleSubmit:s,handleClose:function(){ReactDOM.unmountComponentAtNode(o)},title:e,field_title:t,default_value:a,checkboxes:i,existing_names:n}),o)}r.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,field_title:PropTypes.string,default_value:PropTypes.string,existing_names:PropTypes.array,checkboxes:PropTypes.array},r.defaultProps={existing_names:[],default_value:"",checkboxes:null};class i extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1,value:null}}componentDidMount(){this.setState({show:!0,value:this.props.option_list[0]})}_handleChange(e){this.setState({value:e.target.value})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(this.state.value),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(a.Dialog,{isOpen:this.state.show,title:this.props.title,onClose:this._cancelHandler,canEscapeKeyClose:!0},React.createElement("div",{className:a.Classes.DIALOG_BODY},React.createElement(a.FormGroup,{title:this.props.select_label},React.createElement(a.HTMLSelect,{options:this.props.option_list,onChange:this._handleChange,value:this.state.value}))),React.createElement("div",{className:a.Classes.DIALOG_FOOTER},React.createElement("div",{className:a.Classes.DIALOG_FOOTER_ACTIONS},React.createElement(a.Button,{onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{intent:a.Intent.PRIMARY,onClick:this._submitHandler},"Submit"))))}}function o(e,t,s,a,r,n){let o=document.querySelector("#modal-area");ReactDOM.render(React.createElement(i,{handleSubmit:r,handleClose:function(){ReactDOM.unmountComponentAtNode(o)},title:e,select_label:t,submit_text:a,option_list:n,cancel_text:s}),o)}i.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,select_label:PropTypes.string,option_list:PropTypes.array,submit_text:PropTypes.string,cancel_text:PropTypes.string};class l extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1}}componentDidMount(){this.setState({show:!0})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(a.Dialog,{isOpen:this.state.show,title:this.props.title,onClose:this._cancelHandler,canEscapeKeyClose:!0},React.createElement("div",{className:a.Classes.DIALOG_BODY},React.createElement("p",null,this.props.text_body)),React.createElement("div",{className:a.Classes.DIALOG_FOOTER},React.createElement("div",{className:a.Classes.DIALOG_FOOTER_ACTIONS},React.createElement(a.Button,{onClick:this._cancelHandler},"Cancel"),React.createElement(a.Button,{intent:a.Intent.PRIMARY,onClick:this._submitHandler},"Submit"))))}}function c(e,t,s,a,r){let n=document.querySelector("#modal-area");ReactDOM.render(React.createElement(l,{handleSubmit:r,handleClose:function(){ReactDOM.unmountComponentAtNode(n)},title:e,text_body:t,submit_text:a,cancel_text:s}),n)}confirmDialog.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,text_body:PropTypes.string,submit_text:PropTypes.string,cancel_text:PropTypes.string};(class extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1}}componentDidMount(){this.setState({show:!0})}_closeHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(a.Dialog,{isOpen:this.state.show,title:this.props.title,onClose:this._closeHandler,canEscapeKeyClose:!0},React.createElement("div",{className:a.Classes.DIALOG_BODY},React.createElement("p",null,this.props.text_body)),React.createElement("div",{className:a.Classes.DIALOG_FOOTER},React.createElement("div",{className:a.Classes.DIALOG_FOOTER_ACTIONS},React.createElement(a.Button,{onClick:this._closeHandler},"Okay"))))}}).propTypes={handleClose:PropTypes.func,title:PropTypes.string,text_body:PropTypes.string,close_text:PropTypes.string}},,function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a=React.createContext({readOnly:!1})},function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s(1);class r{constructor(e,t){this.name_space=e,this.recInterval=null,this.retry_interval=t,this.connectme(),this.initialize_socket_stuff(),this.watchForDisconnect()}connectme(){use_ssl?this.socket=io.connect(`https://${document.domain}:${location.port}/${this.name_space}`):this.socket=io.connect(`http://${document.domain}:${location.port}/${this.name_space}`)}initialize_socket_stuff(){}watchForDisconnect(){let e=this;this.socket.on("disconnect",(function(){Object(a.b)({message:"lost server connection"}),e.socket.close(),e.recInterval=setInterval((function(){e.attemptReconnect()}),e.retry_interval)}))}attemptReconnect(){this.socket.connected?(clearInterval(this.recInterval),this.initialize_socket_stuff(),this.watchForDisconnect(),Object(a.b)({message:"reconnected to server"})):this.connectme()}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r}));s(2);class a extends React.Component{constructor(e){super(e),this.left_pane_ref=React.createRef(),this.right_pane_ref=React.createRef(),this.top_ref=null==this.props.top_ref?React.createRef():this.props.top_ref,this.old_left_width=0,this.old_right_width=0,this.state=this.state={current_width_fraction:this.props.initial_width_fraction,mounted:!1}}componentDidMount(){this.turn_on_horizontal_resize(),window.addEventListener("resize",this.resize_to_window),this.setState({mounted:!0},()=>{this.props.handleSplitUpdate&&this.props.handleSplitUpdate(this.left_width,this.right_width,this.state.current_width_fraction)})}componentDidUpdate(){this.notifySplitUpate()}turn_on_horizontal_resize(){let e=this;$(this.left_pane_ref.current).resizable({handles:"e",resize:function(t,s){let a=1*s.size.width/e.props.available_width;s.position.left=s.originalPosition.left,e.update_width_fraction(a)}})}get left_width(){return this.props.available_width*this.state.current_width_fraction}get right_width(){return(1-this.state.current_width_fraction)*this.props.available_width}update_width_fraction(e){this.setState({current_width_fraction:e})}get width_has_changed(){return this.left_width!=this.old_left_width||this.right_width!=this.old_right_width}notifySplitUpate(){this.width_has_changed&&null!=this.props.handleSplitUpdate&&(this.old_left_width=this.left_width,this.old_right_width=this.right_width,this.props.handleSplitUpdate(this.left_width,this.right_width,this.state.current_width_fraction))}render(){let e={width:this.left_width,height:this.props.available_height,display:"flex",flexDirection:"column"},t={width:this.right_width,height:this.props.available_height,display:"flex",flexDirection:"column"};this.props.hide_me;return React.createElement("div",{className:"d-flex flex-row horizontal-panes",ref:this.props.top_ref},React.createElement("div",{ref:this.left_pane_ref,style:e,className:"res-viewer-resizer"},this.props.left_pane),React.createElement("div",{ref:this.right_pane_ref,style:t},this.props.right_pane))}}a.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,left_pane:PropTypes.object,right_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_width_fraction:PropTypes.number,top_ref:PropTypes.object},a.defaultProps={handleSplitUpdate:null,initial_width_fraction:.5,hide_me:!1,left_margin:null,right_margin:null,top_ref:null};class r extends React.Component{constructor(e){super(e),this.top_pane_ref=React.createRef(),this.bottom_pane_ref=React.createRef(),this.old_bottom_height=0,this.old_top_height=0,this.state=this.state={current_height_fraction:this.props.initial_height_fraction,mounted:!1}}componentDidMount(){this.turn_on_vertical_resize(),this.setState({mounted:!0}),window.addEventListener("resize",this.resize_to_window)}componentDidUpdate(){this.notifySplitUpate()}turn_on_vertical_resize(){let e=this;$(this.top_pane_ref.current).resizable({handles:"s",resize:function(t,s){let a=1*s.size.height/e.props.available_height;e.update_height_fraction(a)}})}get top_height(){return this.props.available_height*this.state.current_height_fraction}get bottom_height(){return(1-this.state.current_height_fraction)*this.props.available_height}notifySplitUpate(){null!=this.props.handleSplitUpdate&&this.height_has_changed&&(this.old_top_height=this.top_height,this.old_bottom_height=this.bottom_height,this.props.handleSplitUpdate(this.top_height,this.bottom_height,this.state.current_height_fraction))}update_height_fraction(e){this.setState({current_height_fraction:e})}get height_has_changed(){return this.top_height!=this.old_top_height||this.bottom_height!=this.old_bottom_height}render(){let e={width:this.props.available_width,height:this.top_height,overflowY:"scroll"};this.props.hide_top&&(e.display="none");let t={width:this.props.available_width,height:this.bottom_height,overflowY:"scroll"};return React.createElement("div",{className:"d-flex flex-column"},React.createElement("div",{ref:this.top_pane_ref,style:e},this.props.top_pane),React.createElement("div",{ref:this.bottom_pane_ref,style:t},this.props.bottom_pane))}}r.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,top_pane:PropTypes.object,hide_top:PropTypes.bool,bottom_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_height_fraction:PropTypes.number},r.defaultProps={handleSplitUpdate:null,initial_height_fraction:.5,hide_top:!1}},function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));var a=blueprint;let r=$SCRIPT_ROOT+"/library",n=$SCRIPT_ROOT+"/repository",i=$SCRIPT_ROOT+"/account_info",o=$SCRIPT_ROOT+"/login";class l extends React.Component{handle_signout(){doSignOut(window.page_id)}getIntent(e){return this.props.selected==e?"primary":null}render(){let e=React.createElement(React.Fragment,null,React.createElement(a.Button,{icon:"home",minimal:!0,text:"My Resources",intent:this.getIntent("library"),onClick:()=>{window.open(r)}}),React.createElement(a.Button,{icon:"database",minimal:!0,text:"Repository",intent:this.getIntent("repository"),onClick:()=>{window.open(n)}}),React.createElement(a.Button,{icon:"settings",minimal:!0,text:this.props.user_name,intent:this.getIntent("account"),onClick:()=>{window.open(i)}}),React.createElement(a.Button,{icon:"log-out",minimal:!0,text:"Logout",intent:this.getIntent("logout"),onClick:this.handle_signout})),t=React.createElement(a.Button,{icon:"log-in",minimal:!0,text:"Login",intent:this.getIntent("login"),onClick:()=>{window.open(o)}});this.props.menus;return React.createElement(a.Navbar,null,React.createElement(a.Navbar.Group,{align:a.Alignment.LEFT},React.createElement(a.Navbar.Heading,null,React.createElement("img",{className:"mr-2",src:window.tactic_img_url,alt:"",width:"32 ",height:"32"}),"Tactic"),null!=this.props.menus&&React.createElement(React.Fragment,null,this.props.menus)),React.createElement(a.Navbar.Group,{align:a.Alignment.RIGHT},React.createElement(a.NavbarDivider,null),React.createElement(a.Button,{icon:"manual",minimal:!0,text:"docs",onClick:()=>{window.open("http://tactic.readthedocs.io/en/latest/index.html")}}),this.props.is_authenticated&&e,!this.props.is_authenticated&&t))}}function c(e=null){let t=document.querySelector("#navbar-root");ReactDOM.render(React.createElement(l,{is_authenticated:window.is_authenticated,selected:e,user_name:window.username}),t)}l.propTypes={is_authenticated:PropTypes.bool,img_url:PropTypes.string,user_name:PropTypes.string,menus:PropTypes.object,selected:PropTypes.string},l.defaultProps={menus:null,selected:null}},function(e,t,s){"use strict";s.d(t,"c",(function(){return _})),s.d(t,"a",(function(){return h})),s.d(t,"b",(function(){return o}));var a=s(3),r=s(0);const n="btn-outline-secondary";var i=blueprint;function o(e){return React.createElement("div",{style:{marginTop:20}},React.createElement(_,{button_groups:e.button_groups}),React.createElement(h,{resource_name:e.resource_name,res_type:e.res_type}))}class l extends React.Component{constructor(e){super(e)}render(){return React.createElement(i.Button,{text:this.props.name_text,icon:this.props.icon_name,style:{flexDirection:"column",fontSize:8,padding:"5px 8px",width:42,height:42},large:!0,minimal:!1,onClick:this.props.click_handler,className:"bp-toolbar-button bp3-elevation-0"})}}l.propTypes={icon_name:PropTypes.string,click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,small_size:PropTypes.bool,intent:PropTypes.string},l.defaultProps={small_size:!0,intent:"regular"};class c extends React.Component{constructor(e){super(e),doBinding(this)}render(){let e=this.props.option_list.map((e,t)=>React.createElement(i.MenuItem,{key:e.opt_name,onClick:e.opt_func,icon:e.opt_icon,text:e.opt_name})),t=React.createElement(i.Menu,null,e," ");return React.createElement(i.ButtonGroup,null,React.createElement(i.Popover,{content:t},React.createElement(i.Button,{id:this.props.name,text:this.props.name,icon:this.props.icon_name})))}}c.propTypes={button_class:PropTypes.string,name:PropTypes.string,icon_name:PropTypes.string,option_list:PropTypes.array,small_size:PropTypes.bool},c.defaultProps={small_size:!0};class p extends React.Component{constructor(e){super(e),doBinding(this),this.state={file_list:null,hasSelection:!1,the_text:"Choose file..."}}_handleFileChange(e){let t,s=e.target.files;0!=s.length&&(t=1==s.length?s[0].name:"<multiple>",this.setState({file_list:s,hasSelection:!0,the_text:t}))}_do_submit(e){e.preventDefault(),this.props.click_handler(this.state.file_list)}render(){return React.createElement(React.Fragment,null,React.createElement(i.Button,{text:this.props.name_text,icon:this.props.icon_name,style:{flexDirection:"column",fontSize:8,marginRight:4,width:42,height:42},large:!0,onClick:this._do_submit,className:"bp-toolbar-button"}),React.createElement(i.FileInput,{large:!1,text:this.state.the_text,style:{width:200,fontSize:12},hasSelection:this.state.hasSelection,onInputChange:this._handleFileChange,inputProps:{multiple:this.props.multiple}}))}}p.propTypes={click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,multiple:PropTypes.bool,icon_name:PropTypes.string,small_size:PropTypes.bool},p.defaultProps={small_size:!0,multiple:!1};class _ extends React.Component{get_button_class(e){return null==e.button_class?n:e.button_class}render(){const e=[];var t=0;if(null!=this.props.popup_buttons&&0!=this.props.popup_buttons.length){let t=this.props.popup_buttons.map((e,t)=>React.createElement(i.ButtonGroup,{className:"toolbar-button-group",role:"group",key:"popup_group"+String(t)},React.createElement(c,{name:e.name,key:e.name,icon_name:e.icon_name,option_list:e.option_list,button_class:this.get_button_class(e)})));e.push(t)}for(let s of this.props.button_groups){let a=s.map((e,t)=>React.createElement(l,{name_text:e.name_text,icon_name:e.icon_name,click_handler:e.click_handler,intent:e.hasOwnProperty("intent")?e.intent:"regular",key:t}));e.push(React.createElement(i.ButtonGroup,{large:!0,style:{justifyContent:"center"},className:"toolbar-button-group",role:"group",key:t},a)),t+=1}if(null!=this.props.file_adders&&0!=this.props.file_adders.length){let s=this.props.file_adders.map((e,t)=>React.createElement(p,{icon_name:e.icon_name,click_handler:e.click_handler,button_class:this.get_button_class(e),name_text:e.name_text,multiple:e.multiple,key:t}));e.push(React.createElement(i.ButtonGroup,{style:{justifyContent:"center"},className:"toolbar-button-group",role:"group",key:t},s))}let s;return s=this.props.alternate_outer_style?this.props.alternate_outer_style:{display:"flex",flexDirection:"row",justifyContent:"space-around",marginBottom:10},React.createElement("div",{style:s},React.createElement("div",null,e))}}_.propTypes={button_groups:PropTypes.array,file_adders:PropTypes.array,popup_buttons:PropTypes.array,alternate_outer_style:PropTypes.object},_.defaultProps={file_adders:null,popup_buttons:null,alternate_outer_style:null};class h extends React.Component{constructor(e){super(e),this.state={current_name:e.resource_name},this.rename_me=this.rename_me.bind(this),this.RenameResource=null==this.props.handleRename?this.defaultRenameResource.bind(this):this.props.handleRename}rename_me(){console.log("entering rename");var e=this,t=this.props.res_type,s=this.state.current_name;$.getJSON($SCRIPT_ROOT+`get_resource_names/${t}`,(function(r){const n=r.resource_names,i=n.indexOf(s);i>=0&&n.splice(i,1),Object(a.b)(`Rename ${t}`,`Name for this ${t}`,e.RenameResource,s,n)}))}defaultRenameResource(e){const t={new_name:e};var s=this;Object(r.b)(`rename_resource/${this.props.res_type}/${this.state.current_name}`,t,(function(t){if(!t.success)return doFlash(t),!1;s.setState({current_name:e}),doFlash(t)}))}render(){let e=null==this.props.handleRename?this.state.current_name:this.props.resource_name;return React.createElement(i.Button,{id:"rename-button",large:!0,minimal:!0,style:{fontSize:20},tabIndex:-1,onClick:this.rename_me},React.createElement("h5",null,e))}}h.propTypes={resource_name:PropTypes.string,res_type:PropTypes.string,handleRename:PropTypes.func},h.defaultProps={handleRename:null}},,,function(e,t,s){"use strict";s.d(t,"a",(function(){return h}));var a=s(5),r=s(0),n=blueprint,i=bpselect;class o extends React.Component{constructor(e){super(e),doBinding(this)}_handleClick(){this.props.handleClick(this.props.item)}render(){return React.createElement(n.MenuItem,{text:this.props.item,key:this.props.item,onClick:this._handleClick,shouldDismissPopover:!0})}}function l(e,{modifiers:t,handleClick:s}){return React.createElement(o,{item:e,handleClick:s})}o.propTypes={item:PropTypes.string,handleClick:PropTypes.func};const c=(e,t,s)=>{return React.createElement(n.MenuItem,{icon:"add",key:"create_item",text:`Create "${e}"`,active:t,onClick:s,shouldDismissPopover:!1})};class p extends React.Component{constructor(e){super(e),doBinding(this),this.state={query:"",suggestions:[]}}componentDidMount(){let e=this,t={res_type:this.props.res_type,is_repository:!1};Object(r.c)("get_tag_list",t).then((function(t){let s=t.tag_list;e.setState({suggestions:s})}))}renderTag(e){return e}_handleDelete(e,t){let s=[...this.props.tags];s.splice(t,1),this.props.handleChange(s)}_handleAddition(e){let t=[...this.props.tags];t.push(e),this.props.handleChange(t)}_filterSuggestion(e,t){if(0==e.length)return!1;return new RegExp("^"+e).test(t)}_createItemFromQuery(e){return e}render(){return this.context.readOnly?React.createElement(n.TagInput,{values:this.props.tags,disabled:!0}):React.createElement(i.MultiSelect,{allowCreate:!0,openOnKeyDown:!0,createNewItemFromQuery:this._createItemFromQuery,createNewItemRenderer:c,resetOnSelect:!0,itemRenderer:l,selectedItems:this.props.tags,allowNew:!0,items:this.state.suggestions,itemPredicate:this._filterSuggestion,tagRenderer:this.renderTag,tagInputProps:{onRemove:this._handleDelete},onItemSelect:this._handleAddition})}}p.proptypes={tags:PropTypes.array,handleChange:PropTypes.func,res_type:PropTypes.string},p.contextType=a.a;class _ extends React.Component{constructor(e){super(e),this.state={md_height:500,show_markdown:!this.hasOnlyWhitespace&&this.props.show_markdown_initial},doBinding(this),this.md_ref=React.createRef(),this.converter=new showdown.Converter,this.awaiting_focus=!1}getNotesField(){return $(this.notes_ref)}get hasOnlyWhitespace(){return!this.props.notes.trim().length}getMarkdownField(){return $(this.md_ref.current)}componentDidUpdate(e,t,s){this.awaiting_focus?(this.focusNotes(),this.awaiting_focus=!1):this.state.show_markdown||this.notes_ref==document.activeElement||this._showMarkdown()}focusNotes(){this.getNotesField().focus()}_hideMarkdown(){this.context.readOnly||(this.awaiting_focus=!0,this.setState({show_markdown:!1}))}_handleMyBlur(){this._showMarkdown(),null!=this.props.handleBlur&&this.props.handleBlur()}_showMarkdown(){this.hasOnlyWhitespace||this.setState({show_markdown:!0})}_notesRefHandler(e){this.notes_ref=e}render(){let e=!this.hasOnlyWhitespace&&this.state.show_markdown,t={display:e?"none":"block",fontSize:13},s={display:e?"block":"none",maxHeight:this.state.md_height,fontSize:13};var a;e&&(a=this.converter.makeHtml(this.props.notes));let r={__html:a};return React.createElement(React.Fragment,null,React.createElement(n.TextArea,{rows:"10",cols:"50",inputRef:this._notesRefHandler,growVertically:!1,onBlur:this._handleMyBlur,onChange:this.props.handleChange,value:this.props.notes,disabled:this.context.readOnly,style:t}),React.createElement("div",{ref:this.md_ref,style:s,onClick:this._hideMarkdown,className:"notes-field-markdown-output",dangerouslySetInnerHTML:r}))}}_.contextType=a.a,_.propTypes={notes:PropTypes.string,handleChange:PropTypes.func,show_markdown_initial:PropTypes.bool,handleBlur:PropTypes.func},_.defaultProps={handleBlur:null};class h extends React.Component{constructor(e){super(e),doBinding(this)}_handleNotesChange(e){this.props.handleChange({notes:e.target.value})}_handleTagsChange(e){this.props.handleChange({tags:e})}_handleTagsChangeNative(e){this.props.handleChange({tags:e})}_handleCategoryChange(e){this.props.handleChange({category:e.target.value})}render(){let e;if(null!=this.props.additional_metadata){e=[];for(let t in this.props.additional_metadata){let s=this.props.additional_metadata[t];if(Array.isArray(s))s=s.join(", ");else if("collection_name"==t){let e=/\.\w*$/.exec(s);null!=e&&(s=e[0].slice(1))}e.push(React.createElement(n.FormGroup,{label:t+": ",key:t,inline:!0},React.createElement(n.InputGroup,{disabled:!0,style:{color:"#394B59"},value:s})))}}return React.createElement(n.Card,{elevation:this.props.elevation,className:"combined-metadata",style:this.props.outer_style},null!=this.props.name&&React.createElement("h5",null,this.props.name),React.createElement(n.FormGroup,{label:"Tags"},React.createElement(p,{tags:this.props.tags,handleChange:this._handleTagsChange,res_type:this.props.res_type})),null!=this.props.category&&React.createElement(n.FormGroup,{label:"Category"},React.createElement(n.InputGroup,{onChange:this._handleCategoryChange,value:this.props.category})),React.createElement(n.FormGroup,{label:"Notes"},React.createElement(_,{notes:this.props.notes,handleChange:this._handleNotesChange,show_markdown_initial:!0,handleBlur:this.props.handleNotesBlur})),React.createElement(n.FormGroup,{label:"Created ",inline:!0},React.createElement(n.InputGroup,{disabled:!0,style:{color:"#394B59"},value:this.props.created})),null!=this.props.updated&&React.createElement(n.FormGroup,{label:"Updated: ",inline:!0},React.createElement(n.InputGroup,{disabled:!0,style:{color:"#394B59"},value:this.props.updated})),null!=this.props.additional_metadata&&e)}}h.propTypes={outer_style:PropTypes.object,elevation:PropTypes.number,res_type:PropTypes.string,name:PropTypes.string,created:PropTypes.string,updated:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,category:PropTypes.string,handleChange:PropTypes.func,handleNotesBlur:PropTypes.func,additional_metadata:PropTypes.object},h.defaultProps={outer_style:{marginLeft:20,overflow:"scroll",padding:15,backgroundColor:"#f5f8fa"},elevation:0,handleNotesBlur:null,category:null,name:null,updated:null,additional_metadata:null}},function(e,t,s){"use strict";s.d(t,"d",(function(){return c})),s.d(t,"a",(function(){return p})),s.d(t,"c",(function(){return _})),s.d(t,"b",(function(){return l}));var a=s(0),r=(window.ReactTransitionGroup,blueprint);let n=bpselect,i=bptable;class o extends React.Component{constructor(e){super(e),doBinding(this)}_handleClick(){this.props.handleClick(this.props.item)}render(){return React.createElement(r.MenuItem,{active:this.props.modifiers.active,text:this.props.item.name,key:this.props.item.name,onClick:this._handleClick,shouldDismissPopover:!0})}}o.propTypes={item:PropTypes.string,modifiers:PropTypes.object,handleClick:PropTypes.func};class l extends React.Component{constructor(e){super(e),doBinding(this)}_itemRenderer(e,{modifiers:t,handleClick:s}){return React.createElement(o,{modifiers:t,item:e,handleClick:s})}_itemPredicate(e,t){if(0==e.length)return!1;e.toLowerCase();return new RegExp("^"+e).test(t.name.toLowerCase())}render(){return React.createElement(n.Omnibar,{items:this.props.items,isOpen:this.props.showOmnibar,onItemSelect:this.props.onItemSelect,itemRenderer:this._itemRenderer,itemPredicate:this._itemPredicate,resetOnSelect:!0,onClose:this.props.handleClose})}}l.propTypes={items:PropTypes.array,onItemSelect:PropTypes.func,showOmnibar:PropTypes.bool,handleClose:PropTypes.func};class c extends React.Component{constructor(e){super(e),doBinding(this)}_handleSearchFieldChange(e){this.props.update_search_state({search_field_value:e.target.value})}_handleClearSearch(){this.props.update_search_state({search_field_value:""})}_handleSearchMetadataChange(e){this.props.update_search_state({search_metadata_checked:e.target.checked})}_handleSearchInsideChange(e){this.props.update_search_state({search_inside_checked:e.target.checked})}_handleSubmit(e){e.preventDefault()}render(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"d-flex flex-row mb-2 mt-2"},React.createElement(r.InputGroup,{type:"search",placeholder:"Search",leftIcon:"search",value:this.props.search_field_value,onChange:this._handleSearchFieldChange,style:{width:265}}),React.createElement(r.Button,{onClick:this._handleClearSearch,className:"ml-2"},"clear"),this.props.allow_search_metadata&&React.createElement(r.Switch,{label:"metadata",className:"ml-2",large:!1,checked:this.props.search_metadata_checked,onChange:this._handleSearchMetadataChange}),this.props.allow_search_inside&&React.createElement(r.Switch,{label:"inside",className:"ml-2",large:!1,checked:this.props.search_inside_checked,onChange:this._handleSearchInsideChange})))}}c.propTypes={allow_search_inside:PropTypes.bool,allow_search_metadata:PropTypes.bool,update_search_state:PropTypes.func,search_field_value:PropTypes.string,search_inside_checked:PropTypes.bool,search_metadata_checked:PropTypes.bool};class p extends React.Component{constructor(e){super(e),doBinding(this),this.state={columnWidths:null}}componentDidMount(){this.computeColumnWidths()}computeColumnWidths(){if(0==this.props.data_list.length)return;let e=function(e,t){e.length;const s=h;let a,r,n,i=$($(".bp3-table-truncated-text")[0]).css("font"),o=document.getElementById("measure-canvas").getContext("2d"),l={},c=[];for(let t of e)l[t]=0,c.push(t);o.font=i;for(let e=0;e<t.length&&0!=c.length;++e){a=t[e];let i=[];for(let e of c)n=a[e],(r=o.measureText(n).width+15)>s&&(r=s,i.push(e)),r>l[e]&&(l[e]=r);for(let e of i){let t=c.indexOf(e);-1!==t&&c.splice(t,1)}}let p=[];for(let t of e)p.push(l[t]);return p}(Object.keys(this.props.columns),this.props.data_list);this.setState({columnWidths:e})}componentDidUpdate(){null==this.state.columnWidths&&this.computeColumnWidths()}_cellRendererCreator(e){let t=this;return s=>{let a;return a=Object.keys(t.props.data_list[s]).includes(e)?t.props.data_list[s][e]:"",React.createElement(i.Cell,{key:e,interactive:!0,truncated:!0,tabIndex:-1,wrapText:!0},React.createElement(React.Fragment,null,React.createElement("div",{onDoubleClick:()=>t.props.handleRowDoubleClick(t.props.data_list[s])},a)))}}_renderMenu(e){return React.createElement(r.Menu,null,React.createElement(r.MenuItem,{icon:"sort-asc",onClick:()=>{this.props.sortColumn(e,this.props.columns[e].sort_field,"ascending")},text:"Sort Asc"}),React.createElement(r.MenuItem,{icon:"sort-desc",onClick:()=>{this.props.sortColumn(e,this.props.columns[e].sort_field,"descending")},text:"Sort Desc"}))}render(){let e=this,t=Object.keys(this.props.columns).map(t=>{const s=e._cellRendererCreator(t);return React.createElement(i.Column,{cellRenderer:s,enableColumnReordering:!1,columnHeaderCellRenderer:()=>React.createElement(i.ColumnHeaderCell,{name:t,menuRenderer:()=>e._renderMenu(t)}),key:t,name:t})});return React.createElement(i.Table,{numRows:this.props.data_list.length,enableColumnReordering:!1,enableMultipleSelection:!0,defaultRowHeight:23,selectedRegions:this.props.selectedRegions,enableRowHeader:!1,columnWidths:this.state.columnWidths,selectionModes:[i.RegionCardinality.FULL_ROWS,i.RegionCardinality.CELLS],onSelection:e=>this.props.onSelection(e,this.props.data_list)},t)}}p.propTypes={columns:PropTypes.object,selectedRegions:PropTypes.array,data_list:PropTypes.array,sortColumn:PropTypes.func,onSelection:PropTypes.func,handleRowDoubleClick:PropTypes.func,identifier_field:PropTypes.string,handleAddTag:PropTypes.func},p.defaultProps={columns:{name:{sort_field:"name",first_sort:"ascending"},created:{sort_field:"created_for_sort",first_sort:"descending"},updated:{sort_field:"updated_for_sort",first_sort:"ascending"},tags:{sort_field:"tags",first_sort:"ascending"}},identifier_field:"name",active_row:0,show_animations:!1,handleSpaceBarPress:null,draggable:!0};class _ extends React.Component{constructor(e){super(e),this.state={default_list:[],failed_list:[],other_list:[]}}set_state_from_dict(e){this.setState({default_list:e.default_tiles,failed_list:e.failed_loads,other_list:e.nondefault_tiles})}componentDidMount(){let e=this;this.props.tsocket.socket.on("update-loaded-tile-list",t=>e.set_state_from_dict(t.tile_load_dict)),Object(a.b)("get_loaded_tile_lists",{},(function(t){let s=t.tile_load_dict;e.set_state_from_dict(s)}))}render(){let e=this.state.default_list.map(e=>React.createElement("p",{key:e},e)),t=this.state.failed_list.map(e=>React.createElement("p",{key:e},React.createElement("a",{style:{color:"red"}},e+"(failed)"))),s=this.state.other_list.map(e=>React.createElement("p",{key:e},e));return React.createElement("div",{id:"loaded_tile_widget",className:"d-flex flex-row"},React.createElement(r.Card,null,React.createElement("h6",null,"Loaded Default"),e,t),React.createElement(r.Card,{style:{marginLeft:10}},React.createElement("h6",null,"Loaded Other"),s))}}_.propTypes={tsocket:PropTypes.object};const h=300},function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));class a extends React.Component{constructor(e){super(e),doBinding(this),this.mousetrap=null}componentDidMount(){this.initializeMousetrap()}componentWillUnmount(){this.mousetrap.reset(),this.mousetrap=null}initializeMousetrap(){if(this.mousetrap&&this.mousetrap.reset(),this.props.target_ref||this.props.global){this.props.global?this.mousetrap=new Mousetrap:this.mousetrap=new Mousetrap(this.props.target_ref);for(let e of this.props.bindings)this.mousetrap.bind(e[0],e[1])}else this.mousetrap=null}componentDidUpdate(){this.mousetrap||this.initializeMousetrap()}render(){return React.createElement("div",null)}}a.propTypes={target_ref:PropTypes.object,bindings:PropTypes.array,global:PropTypes.bool},a.defaultProps={global:!1}},function(e,t,s){"use strict";var a=s(3),r=blueprint;function n(e){var t=[];for(let s of e)t=t.concat(i(s));return t=remove_duplicates(t)}function i(e){if(-1==e.search("/"))return[];{let t=function(e){return e.replace(/\/\w*$/,"")}(e),s=i(t);return s.push(t),s}}function o(e){return e.split("/")}class l extends React.Component{render(){let e="all"==this.props.tagstring;return React.createElement(r.Menu,null,React.createElement(r.MenuItem,{icon:"edit",disabled:e,onClick:()=>this.props.rename_tag(this.props.tagstring),text:"Rename"}),React.createElement(r.MenuItem,{icon:"trash",disabled:e,onClick:()=>this.props.delete_tag(this.props.tagstring),text:"Delete"}))}}class c extends React.Component{constructor(e){super(e),doBinding(this)}_edit_tags(e){this.setState({edit_tags:!this.state.edit_tags}),e.preventDefault()}_renameTagPrep(e,t){let s=o(e),a=s.length,r=[];for(let e of this.props.tag_list){let n=o(e);arraysMatch(n.slice(0,a),s)&&(n[a-1]=t,r.push([e,n.join("/")]))}this.props.doTagRename(r)}_newNode(e,t){let s=[...t];s.push(e);let a=s.join("/");return{id:a,childNodes:[],label:e,icon:"tag",hasCaret:!1,isSelected:a==this.props.active_tag,isExpanded:this.props.expanded_tags.includes(a),nodeData:{tag_string:a}}}_nodeChild(e,t){for(let s of e.childNodes)if(s.label==t)return s;return null}_handleNodeExpand(e){if(!this.props.expanded_tags.includes(e.nodeData.tag_string)){let t=[...this.props.expanded_tags];t.push(e.nodeData.tag_string),this.props.updateTagState({expanded_tags:t})}}_handleNodeShrink(e){if(this.props.expanded_tags.includes(e.nodeData.tag_string)){let s=[...this.props.expanded_tags];var t=s.indexOf(e.nodeData.tag_string);-1!==t&&s.splice(t,1),this.props.updateTagState({expanded_tags:s})}}_handleNodeClick(e){this.props.updateTagState({active_tag:e.nodeData.tag_string})}addChildren(e,t,s){if(0==t.length)return;let a=this._newNode(t[0],s);e.childNodes.push(a),e.icon="folder-close",e.hasCaret=!0;let r=[...t],n=[...s],i=r.shift();n.push(i),this.addChildren(a,r,n)}_digNode(e,t,s){if(0==t.length)return;let a=this._nodeChild(e,t[0]);if(null==a)this.addChildren(e,t,s);else{let e=[...t],r=[...s],n=e.shift();r.push(n),t.shift(),this._digNode(a,e,r)}}_buildTree(e){let t=this._newNode("all",[]);t.icon="clean";let s={childNodes:[t]};for(let t of e){let e=o(t);this._digNode(s,e,[])}return s.childNodes}get_tag_base(e){if(-1==e.search("/"))return e;return/\/\w*$/.exec(e)[0].slice(1)}_rename_tag(e){let t=this,s=this.get_tag_base(e);Object(a.b)(`Rename tag "${s}"`,"New name for this tag",(function(s){t._renameTagPrep(e,s)}),s)}_delete_tag(e){const t=`Are you sure that you want to delete the tag "${e}" for this resource type?`;let s=this;Object(a.a)(`Delete tag "${e}"`,t,"do nothing","delete",(function(){s.props.doTagDelete(e)}))}_showContextMenu(e,t,s){s.preventDefault();let a=React.createElement(l,{tagstring:e.nodeData.tag_string,delete_tag:this._delete_tag,rename_tag:this._rename_tag});r.ContextMenu.show(a,{left:s.clientX,top:s.clientY})}render(){let e=n(this.props.tag_list),t=[...this.props.tag_list];t=t.concat(e),(t=remove_duplicates(t)).sort();let s=this._buildTree(t);return React.createElement("div",{style:{marginTop:65,overflowY:"scroll",minWidth:165},className:"tactic-tag-button-list"},React.createElement(r.Tree,{contents:s,onNodeContextMenu:this._showContextMenu,onNodeClick:this._handleNodeClick,onNodeCollapse:this._handleNodeShrink,onNodeExpand:this._handleNodeExpand}))}}c.propTypes={res_type:PropTypes.string,tag_list:PropTypes.array,updateTagState:PropTypes.func,doTagDelete:PropTypes.func,doTagRename:PropTypes.func,handleAddTag:PropTypes.func};var p=s(12),_=s(13),h=s(7),d=s(0),u=s(2),m=s(1),f=s(14);s.d(t,"a",(function(){return y}));var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e};let b=blueprint,w=bptable;class y extends React.Component{constructor(e){super(e),this.top_ref=React.createRef(),this.table_ref=React.createRef();let t=Object(u.d)().usable_height,s=Object(u.d)().usable_width-170;this.state={data_list:[],mounted:!1,available_height:t,available_width:s,top_pane_height:t/2-50,match_list:[],tag_list:[],auxIsOpen:!1,showOmnibar:!1},doBinding(this),null==e.tsocket||this.props.is_repository||(e.tsocket.socket.on(`update-${e.res_type}-selector-row`,this._handleRowUpdate),e.tsocket.socket.on(`refresh-${e.res_type}-selector`,this._refresh_func))}_onTableSelection(e,t){if(0==e.length)return;let s=[],a=[],r=[];for(let n of e)if(n.hasOwnProperty("rows")){let e=n.rows[0];r.push(w.Regions.row(e));let i=n.rows[1];for(let n=e;n<=i;++n)a.includes(n)||(a.push(n),s.push(t[n]),r.push(w.Regions.row(n)))}this._handleRowSelection(s),this._updatePaneState({selectedRegions:r})}componentDidMount(){let e,t=this;this.setState({mounted:!0}),e=this.props.is_repository?"repository_resource_list_with_metadata":"resource_list_with_metadata",Object(d.b)(`${e}/${this.props.res_type}`,{},(function(e){t.setState({data_list:e.data_list},()=>{t.update_tag_list(),t._update_match_lists(),t._set_sort_state(t.props.sorting_column,t.props.sorting_field,t.props.sorting_direction)})}))}_handleRowUpdate(e){let t=e.name,s=this.get_data_list_index(t);if(-1==s)this._animation_phase(()=>{this._add_new_row(e)});else{let a=[...this.state.data_list],r=a[s];for(let t in e)r[t]=e[t];t==this.props.selected_resource.name&&this.props.updatePaneState({selected_resource:r}),this.setState({data_list:a},()=>{this._update_match_lists(),this.update_tag_list()})}}delete_row(e){let t=this.get_data_list_index(e),s=[...this.state.data_list];s.splice(t,1),this.props.list_of_selected.includes(e)&&this._updatePaneState({list_of_selected:[],multi_select:!1,selected_resource:{name:"",tags:"",notes:"",updated:"",created:""}}),this.setState({data_list:s},this.update_tag_list)}get_data_list_entry(e){for(let t of this.state.data_list)if(t.name==e)return t;return null}set_in_data_list(e,t,s){let a=[];for(let r of s){if(e.includes(r.name))for(let e in t)r[e]=t[e];a.push(r)}return a}get_data_list_index(e){return this.state.data_list.findIndex(t=>t.name==e)}_saveFromSelectedResource(){const e={res_type:this.props.res_type,res_name:this.props.list_of_selected[0],tags:this.props.selected_resource.tags,notes:this.props.selected_resource.notes};let t=Object.assign({},this.props.selected_resource),s=[...this.props.list_of_selected],a=this;Object(d.c)("save_metadata",e).then((function(e){let r=a.set_in_data_list(s,t,a.state.data_list);a.setState({data_list:r},()=>{a._update_match_lists(),a.update_tag_list()})})).catch(m.b)}_overwriteCommonTags(){const e={res_type:this.props.res_type,res_names:this.props.list_of_selected,tags:this.props.selected_resource.tags},t=this;Object(d.c)("overwrite_common_tags",e).then((function(e){let s=e.updated_tags,a=[...t.state.data_list];for(let e in s)a=t.set_in_data_list([e],{tags:s[e]},a);t.setState({data_list:a},()=>{t._update_match_lists(),t.update_tag_list()})})).catch(m.b)}_handleMetadataChange(e){if(this.props.multi_select){let t=Object.assign({},this.props.selected_resource);(t=Object.assign(t,e)).tags=t.tags.join(" "),this._updatePaneState({selected_resource:t},this._overwriteCommonTags)}else{let t=Object.assign({},this.props.selected_resource);t=Object.assign(t,e),Object.keys(e).includes("tags")?(t.tags=t.tags.join(" "),this._updatePaneState({selected_resource:t},this._saveFromSelectedResource)):this._updatePaneState({selected_resource:t})}}addOneTag(e,t){let s=this.get_data_list_entry(e);if(s.tags.split(" ").includes(t))return;let a=s.tags+" "+t;a=a.trim();let r={res_type:this.props.res_type,res_name:e,tags:a,notes:s.notes},n=this;Object(d.c)("save_metadata",r).then((function(){n._handleRowUpdate({name:e,tags:a})})).catch(m.b)}_updatePaneState(e,t){this.props.updatePaneState(this.props.res_type,e,t)}_updateTagState(e){let t,s=Object.assign({},this.props.tag_button_state),a={tag_button_state:Object.assign(s,e)};e.hasOwnProperty("active_tag")&&e.active_tag!=this.props.tag_button_state.active_tag?("all"==e.active_tag?(a.search_from_tag=!1,a.search_from_field=!1):(a.search_from_tag=!0,a.search_from_field=!1),t=this._update_match_lists):t=null,this.props.updatePaneState(this.props.res_type,a,t)}_handleAddTag(e,t){if(this.props.list_of_selected.includes(e)&&this.props.multi_select){for(let e of this.props.list_of_selected)this.addOneTag(e,t);let e=this.props.selected_resource.tags;if(!e.includes(t)){e=(e=e+" "+t).trim();let s=this.props.selected_resource;s.tags=e,this._updatePaneState({selected_resource:s})}}else this.addOneTag(e,t)}_handleSplitResize(e,t,s){this._updatePaneState({left_width_fraction:s})}_doTagDelete(e){const t={res_type:this.props.res_type,tag:e};let s=this;Object(d.c)("delete_tag",t).then((function(e){s._refresh_func()})).catch(m.b)}get view_views(){return{collection:"/main/",project:"/main_project/",tile:"/last_saved_view/",list:"/view_list/",code:"/view_code/"}}_doTagRename(e){const t={res_type:this.props.res_type,tag_changes:e};let s=this;Object(d.c)("rename_tag",t).then((function(e){s._refresh_func()})).catch(m.b)}_handleRowDoubleClick(e){let t=this.view_views[this.props.res_type];this._updatePaneState({selected_resource:e,multi_select:!1,list_of_selected:[e.name]}),window.open($SCRIPT_ROOT+t+e.name)}_handleRowSelection(e){if(this.props.multi_select||""==this.props.selected_resource.name||this.props.selected_resource.notes==this.get_data_list_entry(this.props.selected_resource.name).notes||this._saveFromSelectedResource(),e.length>1){let t=e[0].tags.split(" "),s=e.slice(1,e.length);for(let e of s){let s=[],a=e.tags.split(" ");for(let e of a)t.includes(e)&&s.push(e),t=s}let a=e.map(e=>e.name),r={name:"__multiple__",tags:t.join(" "),notes:""};this._updatePaneState({multi_select:!0,selected_resource:r,list_of_selected:a})}else{let t=e[0];this._updatePaneState({selected_resource:t,multi_select:!1,list_of_selected:[t.name]})}}_filter_func(e,t){return-1!=e.name.toLowerCase().search(t)}get all_names(){return this.state.data_list.map(e=>e.name)}match_all(){let e=this.all_names;this.setState({match_list:e})}_update_search_state(e){e.search_from_field=!0,e.search_from_tags=!1,this._updatePaneState(e,this._update_match_lists)}update_tag_list(){let e=[];for(let t of this.state.data_list){if(""==t.tags)continue;let s=t.tags.split(" ");for(let t of s)e.includes(t)||e.push(t)}this.setState({tag_list:e})}_update_match_lists(){if(this.props.search_from_tag)this._searchFromTag(this.props.tag_button_state.active_tag);else if(this.props.search_from_field&&""!=this.props.search_field_value)if(this.props.search_inside_checked)this.doSearchInside(this.props.search_field_value,this.props.search_metadata_checked);else if(this.props.search_metadata_checked)this.doSearchMetadata(this.props.search_field_value);else{let e=[];for(let t of this.state.data_list)this._filter_func(t,this.props.search_field_value)&&e.push(t.name);this.setState({match_list:e})}else this.match_all()}_sort_data_list(){if(0==this.state.data_list.length)return;if(null==this.props.sorting_field)return this.state.data_list;let e=this.props.sorting_field,t=this.props.sorting_direction;let s=[...this.state.data_list];s.sort((function(s,a){let r;return r=s[e]<a[e]?-1:s[e]>a[e]?1:0,"descending"==t&&(r*=-1),r})),0==this.props.list_of_selected.length&&this._updatePaneState({selected_resource:s[0],list_of_selected:[s[0].name],multi_select:!1}),this.setState({data_list:s})}_set_sort_state(e,t,s){this._updatePaneState({sorting_column:e,sorting_field:t,sorting_direction:s},this._sort_data_list)}_refresh_for_new_data_list(){this._update_match_lists(),this._sort_data_list(),this.update_tag_list()}doSearchMetadata(e){let t=this,s={search_text:e};Object(d.c)(this.props.search_metadata_view,s).then(e=>{var s=e.match_list;t.setState({match_list:s})}).catch(m.b)}doSearchInside(e,t){let s={search_text:e},a=this;Object(d.c)(this.props.search_inside_view,s).then(e=>{var r=e.match_list;t?Object(d.c)(a.props.search_metadata_view,s).then(e=>{r=r.concat(e.match_list),a.setState({match_list:r})}).catch(m.b):a.setState({match_list:r})}).catch(m.b)}_filter_on_match_list(e){return this.state.match_list.includes(e.name)}tagMatch(e,t){return t.concat(n(t)).includes(e)}_searchFromTag(e){if("all"==e)this.match_all();else{let t=[];for(let s of this.state.data_list){let a=s.tags.toLowerCase().split(" ");this.tagMatch(e,a)&&t.push(s.name)}this.setState({match_list:t})}}get_match_list_index(e){return this.state.data_list.filter(this._filter_on_match_list).findIndex(t=>t.name==e)}_handleArrowKeyPress(e){if(this.props.multi_select)return;let t,s=this.all_names,a=s.indexOf(this.props.selected_resource.name);if("ArrowDown"==e){for(t=a+1;!this.state.match_list.includes(s[t]);)if((t+=1)>=s.length)return}else for(t=a-1;!this.state.match_list.includes(s[t]);)if((t-=1)<0)return;let r=[w.Regions.row(this.get_match_list_index(s[t]))];this._updatePaneState({selected_resource:this.state.data_list[t],list_of_selected:[s[t]],selectedRegions:r})}_view_func(e,t=null){null==t&&(t=this.view_views[this.props.res_type]),this.state.multi_select||window.open($SCRIPT_ROOT+t+this.props.selected_resource.name)}_add_new_row(e){let t=[...this.state.data_list];t.push(e),this.setState({data_list:t},this._refresh_for_new_data_list)}_duplicate_func(e){let t=this.props.res_type,s=this.props.selected_resource.name;$.getJSON($SCRIPT_ROOT+"get_resource_names/"+t,(function(e){Object(a.b)(`Duplicate ${t}`,"New Name",n,s,e.resource_names)}));let r=this;function n(t){const a={new_res_name:t,res_to_copy:s};Object(d.c)(e,a).then(e=>{r._animation_phase(()=>{r._add_new_row(e.new_row)})}).catch(m.b)}}_animation_phase(e){this.setState({show_animations:!0}),e(),this.setState({show_animations:!1})}_delete_func(e){var t,s=this.props.res_type,r=this.props.list_of_selected;if(1==r.length){t=`Are you sure that you want to delete ${r[0]}?`}else t="Are you sure that you want to delete multiple items?";let n=this;Object(a.a)(`Delete ${s}`,t,"do nothing","delete",(function(){Object(d.c)(e,{resource_names:r}).then(()=>{for(let e=0;e<r.length;++e)n.delete_row(r[e]);n._refresh_for_new_data_list()}).catch(m.b)}))}_rename_func(){let e=this.props.res_type,t=this.props.selected_resource.name,s=this;function r(a){const r={new_name:a};Object(d.b)(`rename_resource/${e}/${t}`,r,(function(e){if(!e.success)return Object(m.b)(e),!1;{let e=s.get_data_list_index(t),r=[...s.state.data_list];r[e].name=a,s.setState({data_list:r},s._refresh_for_new_data_list)}}))}$.getJSON($SCRIPT_ROOT+"get_resource_names/"+e,(function(s){const n=s.resource_names,i=n.indexOf(t);i>=0&&n.splice(i,1),Object(a.b)(`Rename ${e}`,"New Name",r,t,n)}))}_repository_copy_func(){let e=this.props.res_type,t=this.props.selected_resource.name;function s(s){const a={res_type:e,res_name:t,new_res_name:s};Object(d.c)("/copy_from_repository",a).then(m.b).catch(m.b)}return $.getJSON($SCRIPT_ROOT+"get_resource_names/"+e,(function(r){Object(a.b)("Import "+e,"New Name",s,t,r.resource_names)})),t}_send_repository_func(){let e=this.props.res_type,t=this.props.selected_resource.name;function s(s){const a={res_type:e,res_name:t,new_res_name:s};Object(d.c)("/send_to_repository",a).then(m.b).catch(m.b)}return $.getJSON($SCRIPT_ROOT+"get_repository_resource_names/"+e,(function(r){Object(a.b)(`Share ${e}`,`New ${e} Name`,s,t,r.resource_names)})),t}_refresh_func(){this.componentDidMount()}_handleTopRightPaneResize(e,t,s){this.setState({top_pane_height:e})}_handleResize(e){for(let t of e)if("pane-holder"==t.target.className)return void this.setState({available_width:t.contentRect.width-this.top_ref.current.offsetLeft,available_height:t.contentRect.height-this.top_ref.current.offsetTop})}_toggleAuxVisibility(){this.setState({auxIsOpen:!this.state.auxIsOpen})}_showOmnibar(){this.setState({showOmnibar:!0})}_omnibarSelect(e){let t=this.view_views[this.props.res_type];window.open($SCRIPT_ROOT+t+e.name),this._closeOmnibar()}_closeOmnibar(){this.setState({showOmnibar:!1})}render(){let e=this.state.available_width*this.props.left_width_fraction;const t=["name","created","created_for_sort","updated","updated_for_sort","tags","notes"];let s,a={};for(let e in this.props.selected_resource)t.includes(e)||(a[e]=this.props.selected_resource[e]);0==Object.keys(a).length&&(a=null);let r=""==this.props.selected_resource.tags?[]:this.props.selected_resource.tags.split(" "),n=React.createElement(p.a,{tags:r,elevation:0,name:this.props.selected_resource.name,created:this.props.selected_resource.created,updated:this.props.selected_resource.updated,notes:this.props.selected_resource.notes,handleChange:this._handleMetadataChange,res_type:this.props.res_type,outer_style:{marginLeft:20,marginTop:90,overflow:"scroll",padding:15,backgroundColor:"#f5f8fa"},handleNotesBlur:this.props.multi_select?null:this._saveFromSelectedResource,additional_metadata:a});if(null==this.props.aux_pane)s=n;else{let e=this.state.auxIsOpen?"Hide":"Show";s=React.createElement(React.Fragment,null,n,React.createElement("div",{className:"d-flex flex-row justify-content-around",style:{marginTop:20}},React.createElement(b.Button,{fill:!1,small:!0,minimal:!1,onClick:this._toggleAuxVisibility},e+" "+this.props.aux_pane_title)),React.createElement(b.Collapse,{isOpen:this.state.auxIsOpen,keepChildrenMounted:!0},this.props.aux_pane))}let i,o=this.state.data_list.filter(this._filter_on_match_list),l=this.props.ToolbarClass;i=this.table_ref&&this.table_ref.current?e-this.table_ref.current.offsetLeft:e-150;let d=[[["up"],()=>this._handleArrowKeyPress("ArrowUp")],[["down"],()=>this._handleArrowKeyPress("ArrowDown")],[["ctrl+space"],this._showOmnibar]],u=React.createElement(React.Fragment,null,React.createElement("div",{className:"d-flex flex-row",style:{maxHeight:"100%"}},React.createElement("div",{className:"d-flex justify-content-around",style:{paddingRight:10}},React.createElement(c,g({res_type:this.props.res_type,tag_list:this.state.tag_list},this.props.tag_button_state,{updateTagState:this._updateTagState,handleAddTag:this._handleAddTag,doTagDelete:this._doTagDelete,doTagRename:this._doTagRename}))),React.createElement("div",{ref:this.table_ref,className:"d-flex flex-column",style:{width:i,padding:5,backgroundColor:"white"}},React.createElement(_.d,{allow_search_inside:this.props.allow_search_inside,allow_search_metadata:this.props.allow_search_metadata,update_search_state:this._update_search_state,search_field_value:this.props.search_field_value,search_inside_checked:this.props.search_inside_checked,search_metadata_checked:this.props.search_metadata_checked}),React.createElement(_.a,{data_list:o,sortColumn:this._set_sort_state,selectedRegions:this.props.selectedRegions,onSelection:this._onTableSelection,handleRowDoubleClick:this._handleRowDoubleClick,handleAddTag:this._handleAddTag}))));return React.createElement(b.ResizeSensor,{onResize:this._handleResize,observeParents:!0},React.createElement("div",{ref:this.top_ref,className:"d-flex flex-column mt-4"},React.createElement(l,g({selected_resource:this.props.selected_resource,multi_select:this.props.multi_select,list_of_selected:this.props.list_of_selected,view_func:this._view_func,send_repository_func:this._send_repository_func,repository_copy_func:this._repository_copy_func,duplicate_func:this._duplicate_func,refresh_func:this._refresh_func,delete_func:this._delete_func,rename_func:this._rename_func,animation_phase:this._animation_phase,add_new_row:this._add_new_row,startSpinner:this.props.startSpinner,stopSpinner:this.props.stopSpinner,clearStatusMessage:this.props.clearStatusMessage},this.props.errorDrawerFuncs)),React.createElement(h.a,{available_width:this.state.available_width,available_height:this.state.available_height,left_pane:u,right_pane:s,initial_width_fraction:.65,handleSplitUpdate:this._handleSplitResize}),React.createElement(f.a,{global:!0,bindings:d}),React.createElement(_.b,{items:this.state.data_list,onItemSelect:this._omnibarSelect,handleClose:this._closeOmnibar,showOmnibar:this.state.showOmnibar})))}}y.propTypes={res_type:PropTypes.string,allow_search_inside:PropTypes.bool,allow_search_metadata:PropTypes.bool,search_inside_view:PropTypes.string,search_metadata_view:PropTypes.string,ToolbarClass:PropTypes.func,updatePaneState:PropTypes.func,is_repository:PropTypes.bool,tsocket:PropTypes.object,aux_pane:PropTypes.object,left_width_fraction:PropTypes.number,selected_resource:PropTypes.object,sorting_column:PropTypes.string,sorting_field:PropTypes.string,sorting_direction:PropTypes.string,multi_select:PropTypes.bool,list_of_selected:PropTypes.array,search_field_value:PropTypes.string,search_inside_checked:PropTypes.bool,search_metadata_checked:PropTypes.bool,search_tag:PropTypes.string,search_from_field:PropTypes.bool,search_from_tag:PropTypes.bool,tag_button_state:PropTypes.object},y.defaultProps={is_repository:!1,tsocket:null,aux_pane:null}},function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s(1),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},n=blueprint;function i(e,t=null,s=null,a="right",n="30%"){return class extends React.Component{constructor(e){super(e),doBinding(this),this.tsocket=t,this.state={show_drawer:!1,contents:[],error_drawer_size:n,position:a}}componentDidMount(){this.tsocket&&(this.tsocket.socket.on("close-error-drawer",this._close),this.tsocket.socket.on("open-error-drawer",this._open),this.tsocket.socket.on("add-error-drawer-entry",this._addEntry),this.tsocket.socket.on("clear-error-drawer",this._clearAll))}_close(){this.setState({show_drawer:!1})}_open(){this.setState({show_drawer:!0})}_toggle(){this.setState({show_drawer:!this.state.show_drawer})}_addEntry(e,t=!0){this.setState({contents:[...this.state.contents,e],show_drawer:t})}_clearAll(){this.setState({contents:[]})}_onClose(){this.setState({show_drawer:!1})}render(){let t={openErrorDrawer:this._open,closeErrorDrawer:this._close,clearErrorDrawer:this._clearAll,addErrorDrawerEntry:this._addEntry,toggleErrorDrawer:this._toggle};return React.createElement(React.Fragment,null,React.createElement(e,r({},this.props,t,{errorDrawerFuncs:t})),React.createElement(o,r({},this.state,{title:"Error Drawer",size:this.state.error_drawer_size,onClose:this._onClose,clearAll:this._clearAll})))}}}class o extends React.Component{render(){let e=this.props.contents.map((e,t)=>{let s={__html:e.content};return React.createElement(n.Card,{key:t,interactive:!0,elevation:n.Elevation.TWO,style:{marginBottom:5}},e.title&&React.createElement("h6",null,React.createElement("a",{href:"#"},e.title)),React.createElement("div",{style:{fontSize:12},dangerouslySetInnerHTML:s}))});return React.createElement(n.Drawer,{icon:"console",title:this.props.title,isOpen:this.props.show_drawer,position:this.props.position,canOutsideClickClose:!0,onClose:this.props.onClose,size:this.props.size},React.createElement("div",{className:n.Classes.DRAWER_BODY},React.createElement("div",{className:"d-flex flex-row justify-content-around mt-2"},React.createElement(n.Button,{text:"Clear All",onClick:this.props.clearAll})),React.createElement("div",{className:n.Classes.DIALOG_BODY},e)))}}a.a.propTypes={show_drawer:PropTypes.bool,contents:PropTypes.array,title:PropTypes.string,onClose:PropTypes.func,position:PropTypes.string,clearAll:PropTypes.func,size:PropTypes.oneOfType([PropTypes.string,PropTypes.number])},a.a.defaultProps={show_drawer:!1,contents:[],position:"right",title:null,size:"30%"}},,,,,,,function(e,t,s){"use strict";s.r(t);var a=s(3),r=s(9),n=s(6),i=s(8),o=s(0),l=s(1),c=s(5),p=s(15),_=s(13),h=s(2),d=s(16),u=s(14),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},f=blueprint;let g=bptable;let b;class w extends n.a{initialize_socket_stuff(){this.socket.emit("join",{user_id:window.user_id,library_id:window.library_id}),this.socket.on("window-open",e=>window.open(`${$SCRIPT_ROOT}/load_temp_page/${e.the_id}`)),this.socket.on("handle-callback",o.a),this.socket.on("close-user-windows",e=>{e.originator!=window.library_id&&window.close()}),this.socket.on("doflash",l.b)}}var y=["collection","project","tile","list","code"];const R=["collections-pane","projects-pane","tiles-pane","lists-pane","code-pane"];class T extends React.Component{constructor(e){super(e);let t=Object(h.d)().usable_height,s=Object(h.d)().usable_width-170;this.state={selected_tab_id:"collections-pane",usable_width:s,usable_height:t,pane_states:{}};for(let e of y)this.state.pane_states[e]={left_width_fraction:.65,selected_resource:{name:"",tags:"",notes:"",updated:"",created:""},tag_button_state:{expanded_tags:[],active_tag:"all",tree:[]},search_from_field:!1,search_from_tag:!1,sorting_column:"updated",sorting_field:"updated_for_sort",sorting_direction:"descending",multi_select:!1,list_of_selected:[],search_field_value:"",search_inside_checked:!1,search_metadata_checked:!1,selectedRegions:[g.Regions.row(0)]};this.top_ref=React.createRef(),doBinding(this)}componentDidMount(){window.addEventListener("resize",this._update_window_dimensions),this.setState({mounted:!0}),this._update_window_dimensions(),this.props.stopSpinner()}_updatePaneState(e,t,s=null){let a=Object.assign({},this.state.pane_states[e]),r=Object.assign({},this.state.pane_states);r[e]=Object.assign(a,t),this.setState({pane_states:r},s)}_update_window_dimensions(){let e=window.innerWidth-2*h.b,t=window.innerHeight-h.a;this.top_ref&&this.top_ref.current?t-=this.top_ref.current.offsetTop:t-=h.c,this.setState({usable_height:t,usable_width:e})}_handleTabChange(e,t,s){this.setState({selected_tab_id:e},this._update_window_dimensions)}_goToNextPane(){let e=R.indexOf(this.state.selected_tab_id)+1;e==R.length&&(e=0),this.setState({selected_tab_id:R[e]})}render(){let e=React.createElement(_.c,{tsocket:b}),t=React.createElement(p.a,m({},this.props,{res_type:"collection",allow_search_inside:!1,allow_search_metadata:!1,ToolbarClass:v,updatePaneState:this._updatePaneState},this.state.pane_states.collection,this.props.errorDrawerFuncs,{errorDrawerFuncs:this.props.errorDrawerFuncs,tsocket:b})),s=React.createElement(p.a,m({},this.props,{res_type:"project",allow_search_inside:!1,allow_search_metadata:!0,search_metadata_view:"search_project_metadata",ToolbarClass:C,updatePaneState:this._updatePaneState},this.props.errorDrawerFuncs,this.state.pane_states.project,{tsocket:b})),a=React.createElement(p.a,m({},this.props,{res_type:"tile",allow_search_inside:!0,allow_search_metadata:!0,search_inside_view:"search_inside_tiles",search_metadata_view:"search_tile_metadata",ToolbarClass:O,updatePaneState:this._updatePaneState},this.props.errorDrawerFuncs,this.state.pane_states.tile,{tsocket:b,aux_pane_title:"loaded tile list",aux_pane:e})),r=React.createElement(p.a,m({},this.props,{res_type:"list",allow_search_inside:!0,allow_search_metadata:!0,search_inside_view:"search_inside_lists",search_metadata_view:"search_list_metadata",ToolbarClass:E},this.props.errorDrawerFuncs,{updatePaneState:this._updatePaneState},this.state.pane_states.list,{tsocket:b})),n=React.createElement(p.a,m({},this.props,{res_type:"code",allow_search_inside:!0,allow_search_metadata:!0,search_inside_view:"search_inside_code",search_metadata_view:"search_code_metadata",ToolbarClass:x},this.props.errorDrawerFuncs,{updatePaneState:this._updatePaneState},this.state.pane_states.code,{tsocket:b})),i={width:this.state.usable_width,height:this.state.usable_height,paddingLeft:h.b},o=[[["tab"],this._goToNextPane]];return React.createElement(c.a.Provider,{value:{readOnly:!1}},React.createElement("div",{className:"pane-holder",ref:this.top_ref,style:i},React.createElement(f.Tabs,{id:"the_container",style:{marginTop:100},selectedTabId:this.state.selected_tab_id,renderActiveTabPanelOnly:!0,vertical:!0,large:!0,onChange:this._handleTabChange},React.createElement(f.Tab,{id:"collections-pane",panel:t},React.createElement(f.Icon,{icon:"box"}),"  Collections"),React.createElement(f.Tab,{id:"projects-pane",panel:s},React.createElement(f.Icon,{icon:"projects"}),"  Projects"),React.createElement(f.Tab,{id:"tiles-pane",panel:a},React.createElement(f.Icon,{icon:"application"}),"  Tiles"),React.createElement(f.Tab,{id:"lists-pane",panel:r},React.createElement(f.Icon,{icon:"numbered-list"}),"  Lists"),React.createElement(f.Tab,{id:"code-pane",panel:n},React.createElement(f.Icon,{icon:"code"}),"  Code"))),React.createElement(u.a,{global:!0,bindings:o}))}}class S extends React.Component{prepare_button_groups(){let e,t,s=[];for(let a of this.props.button_groups){e=[];for(let s of a)this.props.multi_select&&!s[3]||(t={name_text:s[0],click_handler:s[1],icon_name:s[2],multi_select:s[3]},s.length>4&&(t.intent=s[4]),e.push(t));0!=e.length&&s.push(e)}return s}prepare_file_adders(){if(null==this.props.file_adders||0==this.props.file_adders.length)return[];let e=[];for(let t of this.props.file_adders){let s={name_text:t[0],click_handler:t[1],icon_name:t[2],multiple:t[3]};e.push(s)}return e}prepare_popup_buttons(){if(null==this.props.popup_buttons||0==this.props.popup_buttons.length)return[];let e=[];for(let t of this.props.popup_buttons){let s={name:t[0],icon_name:t[1]},a=[];for(let e of t[2])a.push({opt_name:e[0],opt_func:e[1],opt_icon:e[2]});s.option_list=a,e.push(s)}return e}render(){let e=this.prepare_popup_buttons();return React.createElement(r.c,{button_groups:this.prepare_button_groups(),file_adders:this.prepare_file_adders(),alternate_outer_style:{display:"flex",flexDirection:"row",position:"relative",left:175,marginBottom:10},popup_buttons:e})}}S.propTypes={button_groups:PropTypes.array,file_adders:PropTypes.array,popup_buttons:PropTypes.array,multi_select:PropTypes.bool},S.defaultProps={file_adders:null,popup_buttons:null};let P={view_func:PropTypes.func,duplicate_func:PropTypes.func,delete_func:PropTypes.func,rename_func:PropTypes.func,refresh_func:PropTypes.func,send_repository_func:PropTypes.func,selected_resource:PropTypes.object,list_of_selected:PropTypes.array,muti_select:PropTypes.bool,add_new_row:PropTypes.func,animation_phase:PropTypes.func};class v extends React.Component{constructor(e){super(e),doBinding(this)}_collection_duplicate(){this.props.duplicate_func("/duplicate_collection")}_collection_delete(){this.props.delete_func("/delete_collection")}_combineCollections(){let e=this;function t(t){Object(o.c)("combine_to_new_collection",{original_collections:e.props.list_of_selected,new_name:t}).then(t=>{e.props.animation_phase(()=>{e.props.add_new_row(t.new_row)})}).catch(t=>{e.props.addErrorDrawerEntry({title:"Error combining collections",content:t.message})})}this.props.multi_select?$.getJSON(`${$SCRIPT_ROOT}get_resource_names/collection`,(function(e){Object(a.b)("Combine Collections","Name for combined collection",t,"NewCollection",e.resource_names)})):Object(a.b)("Name of collection to combine with "+this.props.selected_resource.name,"collection Name",(function(t){e.props.startSpinner();const s=`${$SCRIPT_ROOT}/combine_collections/${(void 0)[0]}/${t}`;$.post(s,t=>{e.props.stopSpinner(),t.success||e.props.addErrorDrawerEntry({title:"Error combining collections",content:t.message}),Object(l.b)(t)})}))}_downloadCollection(){let e=this.props.selected_resource.name;Object(a.b)("Download Collection as Excel Notebook","New File Name",(function(t){window.open(`${$SCRIPT_ROOT}/download_collection/`+e+"/"+t)}),e+".xlsx")}displayImportResults(e){let t,s="";if(null==e.file_decoding_errors)e.message="No decoding errors were encounters",e.alert_type="Success",Object(l.b)(e);else{s="<b>Decoding errors were enountered</b>";for(let a in e.file_decoding_errors)s+=`<br>${a}: ${t=String(e.file_decoding_errors[a].length)} errors`;this.props.addErrorDrawerEntry({title:"Collection Created",content:s})}}_import_collection(e){let t=new FormData;for(let s of e)t.append("file",s);let s=this,r=[{checkname:"import_as_freeform",checktext:"Import as freeform"}];function n(e,a){let r;s.props.startSpinner(),r=a.import_as_freeform?"import_as_freeform":"import_as_table",Object(o.d)(`${r}/${e}/${window.library_id}`,t).then(e=>{s.props.clearStatusMessage(),s.displayImportResults(e),s.props.animation_phase(()=>{s.props.add_new_row(e.new_row)}),s.props.stopSpinner()}).catch(e=>{s.props.addErrorDrawerEntry({title:"Error importing documents",content:e.message})})}$.getJSON(`${$SCRIPT_ROOT}get_resource_names/collection`,(function(e){Object(a.b)("Import collection","New collection Name",n,"NewCollection",e.resource_names,r)}))}get button_groups(){return[[["open",this.props.view_func,"document-open",!1,"primary"]],[["duplicate",this._collection_duplicate,"duplicate",!1,"success"],["rename",this.props.rename_func,"edit",!1,"warning"],["combine",this._combineCollections,"merge-columns",!0,"success"]],[["download",this._downloadCollection,"cloud-download",!1,"regular"],["share",this.props.send_repository_func,"share",!1,"regular"]],[["delete",this._collection_delete,"trash",!0,"danger"]],[["refresh",this.props.refresh_func,"refresh",!1]]]}get file_adders(){return[["import",this._import_collection,"cloud-upload",!0]]}render(){return React.createElement(S,{button_groups:this.button_groups,file_adders:this.file_adders,multi_select:this.props.multi_select})}}v.propTypes=P;class C extends React.Component{constructor(e){super(e),doBinding(this)}_project_duplicate(){this.props.duplicate_func("/duplicate_project")}new_notebook(){window.open(`${$SCRIPT_ROOT}/new_notebook`)}_downloadJupyter(){let e=this.props.selected_resource.name;Object(a.b)("Download Notebook as Jupyter Notebook","New File Name",(function(t){window.open(`${$SCRIPT_ROOT}/download_jupyter/`+e+"/"+t)}),e+".ipynb")}_import_jupyter(e){let t=new FormData;for(let s of e)t.append("file",s);let s=this;function r(e,a){s.props.startSpinner(),Object(o.d)(`import_as_jupyter/${e}/${library_id}`,t).then(e=>{s.props.clearStatusMessage(),s.props.animation_phase(()=>{s.props.add_new_row(e.new_row)}),s.props.stopSpinner()}).catch(e=>{s.props.addErrorDrawerEntry({title:"Error importing jupyter notebook",content:e.message})})}$.getJSON(`${$SCRIPT_ROOT}get_resource_names/project`,(function(e){Object(a.b)("Import jupyter","New Jupyter Name",r,"NewJupyterNotebook",e.resource_names,[])}))}_project_delete(){this.props.delete_func("/delete_project")}get button_groups(){return[[["notebook",this.new_notebook,"book",!1],["open",this.props.view_func,"document-open",!1]],[["duplicate",this._project_duplicate,"duplicate",!1],["rename",this.props.rename_func,"edit",!1]],[["toJupyter",this._downloadJupyter,"cloud-download",!1],["share",this.props.send_repository_func,"share",!1]],[["delete",this._project_delete,"trash",!0]],[["refresh",this.props.refresh_func,"refresh",!1]]]}get file_adders(){return[["import",this._import_jupyter,"cloud-upload",!1]]}render(){return React.createElement(S,{button_groups:this.button_groups,file_adders:this.file_adders,multi_select:this.props.multi_select})}}C.propTypes=P;class O extends React.Component{constructor(e){super(e),doBinding(this)}_tile_view(e){this.props.view_func(e,"/view_module/")}_creator_view(e){this.props.view_func(e,"/view_in_creator/")}_tile_duplicate(){this.props.duplicate_func("/create_duplicate_tile")}_compare_tiles(){let e=this.props.list_of_selected;0!=e.length&&(1==e.length?window.open(`${$SCRIPT_ROOT}/show_tile_differ/${e[0]}`):2==e.length?window.open(`${$SCRIPT_ROOT}/show_tile_differ/both_names/${e[0]}/${e[1]}`):Object(l.b)({"alert-type":"alert-warning",message:"Select only one or two tiles before launching compare"}))}_load_tile(){let e=this;Object(o.g)("host","load_tile_module_task",{tile_module_name:this.props.list_of_selected[0],user_id:window.user_id},t=>{t.success?Object(l.b)(t):e.props.addErrorDrawerEntry({title:"Error loading tile",content:t.message})})}_unload_all_tiles(){$.getJSON(`${$SCRIPT_ROOT}/unload_all_tiles`,l.b)}_tile_delete(){this.props.delete_func("/delete_tile_module")}_new_tile(e){$.getJSON($SCRIPT_ROOT+"get_resource_names/tile",(function(e){Object(a.b)("New Tile","New Tile Name",s,"NewTileModule",e.resource_names)}));let t=this;function s(s){const a={template_name:e,new_res_name:s,last_saved:"viewer"};Object(o.c)("/create_tile_module",a).then(e=>{t.props.animation_phase(()=>{t.props.add_new_row(e.new_row)}),window.open($SCRIPT_ROOT+"/view_module/"+String(s))}).catch(e=>{t.props.addErrorDrawerEntry({title:"Error creating new tile",content:e.message})})}}_new_in_creator(e){$.getJSON(`${$SCRIPT_ROOT}/get_resource_names/tile`,(function(e){Object(a.b)("New Tile","New Tile Name",s,"NewTileModule",e.resource_names)}));let t=this;function s(s){const a={template_name:e,new_res_name:s,last_saved:"creator"};Object(o.c)("/create_tile_module",a).then(e=>{t.props.animation_phase(()=>{t.props.add_new_row(e.new_row)}),window.open($SCRIPT_ROOT+"/view_in_creator/"+String(s))}).catch(e=>{t.props.addErrorDrawerEntry({title:"Error creating new tile",content:e.message})})}}get popup_buttons(){return[["new","new-text-box",[["BasicTileTemplate",()=>{this._new_tile("BasicTileTemplate")},"code"],["ExpandedTileTemplate",()=>{this._new_tile("ExpandedTileTemplate")},"code"],["MatplotlibTileTemplate",()=>{this._new_tile("MatplotlibTileTemplate")},"timeline-line-chart"]]],["creator","new-text-box",[["StandardTile",()=>{this._new_in_creator("BasicTileTemplate")},"code"],["MatplotlibTile",()=>{this._new_in_creator("MatplotlibTileTemplate")},"timeline-line-chart"],["D3Tile",()=>{this._new_in_creator("D3TileTemplate")},"timeline-area-chart"]]]]}get button_groups(){return[[["edit",this._tile_view,"edit",!1],["creator",this._creator_view,"annotation",!1],["compare",this._compare_tiles,"comparison",!0],["load",this._load_tile,"upload",!1],["unload",this._unload_all_tiles,"clean",!1]],[["duplicate",this._tile_duplicate,"duplicate",!1],["rename",this.props.rename_func,"edit",!1]],[["share",this.props.send_repository_func,"share",!1]],[["delete",this._tile_delete,"trash",!0]],[["refresh",this.props.refresh_func,"refresh",!1]],[["drawer",this.props.toggleErrorDrawer,"console",!1]]]}render(){return React.createElement(S,{button_groups:this.button_groups,popup_buttons:this.popup_buttons,multi_select:this.props.multi_select})}}O.propTypes=P;class E extends React.Component{constructor(e){super(e),doBinding(this)}_list_duplicate(){this.props.duplicate_func("/create_duplicate_list")}_list_delete(){this.props.delete_func("/delete_list")}_add_list(e){let t=new FormData;for(let s of e)t.append("file",s);let s=this;Object(o.d)("add_list",t).then(e=>{s.props.animation_phase(()=>{s.props.add_new_row(e.new_row)})}).catch(e=>{s.props.addErrorDrawerEntry({title:"Error creating new list",content:e.message})})}get button_groups(){return[[["edit",this.props.view_func,"document-open",!1]],[["duplicate",this._list_duplicate,"duplicate",!1],["rename",this.props.rename_func,"edit",!1]],[["share",this.props.send_repository_func,"share",!1]],[["delete",this._list_delete,"trash",!0]],[["refresh",this.props.refresh_func,"refresh",!1]]]}get file_adders(){return[["import",this._add_list,"cloud-upload",!0]]}render(){return React.createElement(S,{button_groups:this.button_groups,popup_buttons:this.popup_buttons,multi_select:this.props.multi_select})}}E.propTypes=P;class x extends React.Component{constructor(e){super(e),doBinding(this)}_new_code(e){$.getJSON(`${$SCRIPT_ROOT}/get_resource_names/code`,(function(e){Object(a.b)("New Code Resource","New Code Resource Name",s,"NewCodeResource",e.resource_names)}));let t=this;function s(s){const a={template_name:e,new_res_name:s};Object(o.c)("/create_code",a).then(e=>{t.props.animation_phase(()=>{t.props.add_new_row(e.new_row)}),window.open($SCRIPT_ROOT+"/view_code/"+String(s))}).catch(e=>{t.props.addErrorDrawerEntry({title:"Error creating new code resource",content:e.message})})}}_code_duplicate(){this.props.duplicate_func("/create_duplicate_code")}_code_delete(){this.props.delete_func("/delete_code")}get popup_buttons(){return[["new","new-text-box",[["BasicCodeTemplate",()=>{this._new_code("BasicCodeTemplate")},"code"]]]]}get button_groups(){return[[["edit",this.props.view_func,"document-open",!1]],[["duplicate",this._code_duplicate,"duplicate",!1],["rename",this.props.rename_func,"edit",!1]],[["share",this.props.send_repository_func,"share",!1]],[["delete",this._code_delete,"trash",!0]],[["refresh",this.props.refresh_func,"refresh",!1]]]}render(){return React.createElement(S,{button_groups:this.button_groups,popup_buttons:this.popup_buttons,multi_select:this.props.multi_select})}}x.propTypes=P,function(){Object(i.b)("library"),b=new w("library",5e3);let e=Object(d.a)(Object(l.e)(T,b),b),t=document.querySelector("#library-home-root");ReactDOM.render(React.createElement(e,null),t)}()}]);