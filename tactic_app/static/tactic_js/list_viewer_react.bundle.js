!function(e){var t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=22)}([function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return r})),s.d(t,"d",(function(){return i})),s.d(t,"f",(function(){return l})),s.d(t,"g",(function(){return p})),s.d(t,"e",(function(){return c}));let n={};function a(e){let t=e.callback_id,s=n[t];delete n[t],s(e.response_data)}function o(e,t,s){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:s})}function r(e,t){return new Promise((function(s,n){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(t),dataType:"json",success:e=>{e.success&&s(e),n(e)}})}))}function i(e,t){return new Promise((function(s,n){"/"==e[0]&&(e=e.slice(1)),$.ajax({url:$SCRIPT_ROOT+"/"+e,type:"POST",data:t,contentType:!1,processData:!1,success:e=>{e.success&&s(e),n(e)}})}))}function l(e,t,s,a){const o={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,expiration:null};if(void 0!==a&&null!=a){const e=guid();n[e]=a,o.callback_id=e,o.callback_type="callback_no_context"}else o.callback_id=null,o.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(o),dataType:"json"})}function c(e,t,s){const n={source:"client",dest:e,task_type:t,task_data:s,response_data:null,main_id:main_id,callback_id:null,callback_type:"no_callback",expiration:null};$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!1,data:JSON.stringify(n),dataType:"json"})}function p(e,t,s,a){const o={source:"client",dest:e,task_type:t,task_data:s,response_data:null,expiration:null};if(void 0!==a){const e=guid();n[e]=a,o.callback_id=e,o.callback_type="callback_no_context"}else o.callback_id=null,o.callback_type="no_callback";$.ajax({url:$SCRIPT_ROOT+"/post_from_client",contentType:"application/json",type:"POST",async:!0,data:JSON.stringify(o),dataType:"json"})}},function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return c})),s.d(t,"c",(function(){return i}));var n=window.ReactBootstrap;class a extends React.Component{constructor(e){super(e),doBinding(this);let t=this.props.default_value;for(var s=1;this.name_exists(t);)s+=1,t=this.props.default_value+String(s);this.state={show:!1,current_value:t,checkbox_states:{},warning_text:""}}_changeHandler(e){this.setState({current_value:e.target.value})}_checkbox_change_handler(e){e.target.checked;let t=Object.assign({},this.state.checkbox_states);t[e.target.id]=e.target.checked,this.setState({checkbox_states:t})}componentDidMount(){if(this.setState({show:!0}),null!=this.props.checkboxes&&0!=this.props.checkboxes.length){let e={};for(let t of this.props.checkboxes)e[t.id]=!1;this.setState({checkbox_states:e})}}name_exists(e){return this.props.existing_names.indexOf(e)>-1}_submitHandler(e){let t;""==this.state.current_value?(t="An empty name is not allowed here.",this.setState({warning_text:t})):this.name_exists(this.state.current_value)?(t="That name already exists",this.setState({warning_text:t})):(this.setState({show:!1}),this.props.handleSubmit(this.state.current_value,this.state.checkbox_states),this.props.handleClose())}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){let e=[];if(null!=this.props.checkboxes&&0!=this.props.checkboxes.length)for(let t of this.props.checkboxes){let s=React.createElement(n.Form.Check,{type:"checkbox",label:t.checktext,id:t.checkname,key:t.checkname,onChange:this._checkbox_change_handler});e.push(s)}return React.createElement(n.Modal,{show:this.state.show},React.createElement(n.Modal.Header,{closeButton:!0},React.createElement(n.Modal.Title,null,this.props.title)),React.createElement(n.Modal.Body,null,React.createElement(n.Form.Group,{onSubmit:this._submitHandler},React.createElement(n.Form.Label,null,this.props.field_title),React.createElement(n.Form,null,React.createElement(n.Form.Control,{type:"text",onChange:this._changeHandler,value:this.state.current_value}))),0!=e.length&&e),React.createElement(n.Modal.Footer,null,React.createElement(n.Form.Text,{className:"text-muted"},this.state.warning_text),React.createElement(n.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(n.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function o(e,t,s,n,o,r=null){void 0===o&&(o=[]);let i=document.querySelector("#modal-area");ReactDOM.render(React.createElement(a,{handleSubmit:s,handleClose:function(){ReactDOM.unmountComponentAtNode(i)},title:e,field_title:t,default_value:n,checkboxes:r,existing_names:o}),i)}a.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,field_title:PropTypes.string,default_value:PropTypes.string,existing_names:PropTypes.array,checkboxes:PropTypes.array},a.defaultProps={existing_names:[],default_value:"",checkboxes:null};class r extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1,value:null}}componentDidMount(){this.setState({show:!0,value:this.props.option_list[0]})}_handleChange(e){this.setState({value:e.target.value})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(this.state.value),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(n.Modal,{show:this.state.show},React.createElement(n.Modal.Header,{closeButton:!0},React.createElement(n.Modal.Title,null,this.props.title)),React.createElement(n.Modal.Body,null,React.createElement(n.Form.Group,null,React.createElement(n.Form.Label,null,"Select Label"),React.createElement(n.Form.Control,{as:"select",onChange:this._handleChange,value:this.state.value},this.props.option_list.map((e,t)=>React.createElement("option",{key:t},e))))),React.createElement(n.Modal.Footer,null,React.createElement(n.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(n.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function i(e,t,s,n,a,o){let i=document.querySelector("#modal-area");ReactDOM.render(React.createElement(r,{handleSubmit:a,handleClose:function(){ReactDOM.unmountComponentAtNode(i)},title:e,select_label:t,submit_text:n,option_list:o,cancel_text:s}),i)}r.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,select_label:PropTypes.string,option_list:PropTypes.array,submit_text:PropTypes.string,cancel_text:PropTypes.string};class l extends React.Component{constructor(e){super(e),doBinding(this),this.state={show:!1}}componentDidMount(){this.setState({show:!0})}_submitHandler(e){this.setState({show:!1}),this.props.handleSubmit(),this.props.handleClose()}_cancelHandler(){this.setState({show:!1}),this.props.handleClose()}render(){return React.createElement(n.Modal,{show:this.state.show},React.createElement(n.Modal.Header,{closeButton:!0},React.createElement(n.Modal.Title,null,this.props.title)),React.createElement(n.Modal.Body,null,React.createElement("p",null,this.props.text_body)),React.createElement(n.Modal.Footer,null,React.createElement(n.Button,{variant:"secondary",onClick:this._cancelHandler},"Cancel"),React.createElement(n.Button,{variant:"primary",onClick:this._submitHandler},"Submit")))}}function c(e,t,s,n,a){let o=document.querySelector("#modal-area");ReactDOM.render(React.createElement(l,{handleSubmit:a,handleClose:function(){ReactDOM.unmountComponentAtNode(o)},title:e,text_body:t,submit_text:n,cancel_text:s}),o)}confirmDialog.propTypes={handleSubmit:PropTypes.func,handleClose:PropTypes.func,title:PropTypes.string,text_body:PropTypes.string,submit_text:PropTypes.string,cancel_text:PropTypes.string}},,function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return a}));React.createContext({width:window.innerWidth,height:window.innerHeight});class n extends React.Component{constructor(e){super(e),this.left_pane_ref=React.createRef(),this.right_pane_ref=React.createRef(),this.old_left_width=0,this.old_right_width=0,this.state=this.state={current_width_fraction:this.props.initial_width_fraction,mounted:!1}}componentDidMount(){this.turn_on_horizontal_resize(),window.addEventListener("resize",this.resize_to_window),this.setState({mounted:!0})}componentDidUpdate(){this.notifySplitUpate()}turn_on_horizontal_resize(){let e=this;$(this.left_pane_ref.current).resizable({handles:"e",resize:function(t,s){let n=1*s.size.width/e.props.available_width;s.position.left=s.originalPosition.left,e.update_width_fraction(n)}})}get left_width(){return this.props.available_width*this.state.current_width_fraction}get right_width(){return(1-this.state.current_width_fraction)*this.props.available_width}update_width_fraction(e){this.setState({current_width_fraction:e})}get width_has_changed(){return this.left_width!=this.old_left_width||this.right_width!=this.old_right_width}notifySplitUpate(){this.width_has_changed&&null!=this.props.handleSplitUpdate&&(this.old_left_width=this.left_width,this.old_right_width=this.right_width,this.props.handleSplitUpdate(this.left_width,this.right_width,this.state.current_width_fraction))}render(){let e={width:this.left_width,height:this.props.available_height},t={width:this.right_width,height:this.props.available_height};this.props.hide_me;return React.createElement("div",{className:"d-flex flex-row"},React.createElement("div",{ref:this.left_pane_ref,style:e,className:"res-viewer-resizer"},this.props.left_pane),React.createElement("div",{ref:this.right_pane_ref,style:t},this.props.right_pane))}}n.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,left_pane:PropTypes.object,right_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_width_fraction:PropTypes.number},n.defaultProps={handleSplitUpdate:null,initial_width_fraction:.5,hide_me:!1};class a extends React.Component{constructor(e){super(e),this.top_pane_ref=React.createRef(),this.bottom_pane_ref=React.createRef(),this.old_bottom_height=0,this.old_top_height=0,this.state=this.state={current_height_fraction:this.props.initial_height_fraction,mounted:!1}}componentDidMount(){this.turn_on_vertical_resize(),this.setState({mounted:!0}),window.addEventListener("resize",this.resize_to_window)}componentDidUpdate(){this.notifySplitUpate()}turn_on_vertical_resize(){let e=this;$(this.top_pane_ref.current).resizable({handles:"s",resize:function(t,s){let n=1*s.size.height/e.props.available_height;e.update_height_fraction(n)}})}get top_height(){return this.props.available_height*this.state.current_height_fraction}get bottom_height(){return(1-this.state.current_height_fraction)*this.props.available_height}notifySplitUpate(){null!=this.props.handleSplitUpdate&&this.height_has_changed&&(this.old_top_height=this.top_height,this.old_bottom_height=this.bottom_height,this.props.handleSplitUpdate(this.top_height,this.bottom_height,this.state.current_height_fraction))}update_height_fraction(e){this.setState({current_height_fraction:e})}get height_has_changed(){return this.top_height!=this.old_top_height||this.bottom_height!=this.old_bottom_height}render(){let e={width:this.props.available_width,height:this.top_height,borderBottom:"0.5px solid rgb(238, 238, 238)",overflowY:"scroll"};this.props.hide_top&&(e.display="none");let t={width:this.props.available_width,height:this.bottom_height,overflowY:"scroll"};return React.createElement("div",{className:"d-flex flex-column"},React.createElement("div",{ref:this.top_pane_ref,style:e},this.props.top_pane),React.createElement("div",{ref:this.bottom_pane_ref,style:t},this.props.bottom_pane))}}a.propTypes={available_width:PropTypes.number,available_height:PropTypes.number,top_pane:PropTypes.object,hide_top:PropTypes.bool,bottom_pane:PropTypes.object,handleSplitUpdate:PropTypes.func,initial_height_fraction:PropTypes.number},a.defaultProps={handleSplitUpdate:null,initial_height_fraction:.5,hide_top:!1}},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n=React.createContext({readOnly:!1})},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));class n{constructor(e,t){this.name_space=e,this.recInterval=null,this.retry_interval=t,this.connectme(),this.initialize_socket_stuff(),this.watchForDisconnect()}connectme(){use_ssl?this.socket=io.connect(`https://${document.domain}:${location.port}/${this.name_space}`):this.socket=io.connect(`http://${document.domain}:${location.port}/${this.name_space}`)}initialize_socket_stuff(){}watchForDisconnect(){let e=this;this.socket.on("disconnect",(function(){doFlash({message:"lost server connection"}),e.socket.close(),e.recInterval=setInterval((function(){e.attemptReconnect()}),e.retry_interval)}))}attemptReconnect(){this.socket.connected?(clearInterval(this.recInterval),this.initialize_socket_stuff(),this.watchForDisconnect(),doFlash({message:"reconnected to server"})):this.connectme()}}},function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));var n=window.ReactBootstrap;let a=$SCRIPT_ROOT+"/library",o=$SCRIPT_ROOT+"/repository",r=$SCRIPT_ROOT+"/account_info",i=$SCRIPT_ROOT+"/login";class l extends React.Component{handle_signout(){doSignOut(window.page_id)}render(){let e=React.createElement(React.Fragment,null,React.createElement(n.Nav.Item,null,React.createElement(n.Nav.Link,{href:a},"My Resources")),React.createElement(n.Nav.Item,null,React.createElement(n.Nav.Link,{href:o},"Repository")),React.createElement(n.Nav.Item,null,React.createElement(n.Nav.Link,{href:r},this.props.user_name)),React.createElement(n.Nav.Item,null,React.createElement(n.Nav.Link,{onClick:this.handle_signout},"Logout"))),t=(React.createElement(n.Nav.Item,null,React.createElement(n.Nav.Link,{href:i},"Login")),null==this.props.menus?"justify-content-end":"justify-content-between");return React.createElement(n.Navbar,{bg:"light",expand:"lg",variant:"light"},React.createElement(n.Navbar.Brand,{href:"/"},React.createElement("img",{className:"mr-2",src:window.tactic_img_url,alt:"",width:"32 ",height:"32"}),"Tactic"),React.createElement(n.Navbar.Collapse,{id:"collapse-area",className:t},null!=this.props.menus&&React.createElement(n.Nav,{id:"menu-area"},this.props.menus),React.createElement(n.Nav,null,React.createElement(n.Nav.Link,{href:"http://tactic.readthedocs.io/en/latest/index.html"},"Docs"),this.props.is_authenticated&&e)))}}function c(){let e=document.querySelector("#navbar-root");ReactDOM.render(React.createElement(l,{is_authenticated:window.is_authenticated,user_name:window.username}),e)}l.propTypes={is_authenticated:PropTypes.bool,img_url:PropTypes.string,user_name:PropTypes.string,menus:PropTypes.object},l.defaultProps={menus:null}},function(e,t,s){"use strict";s.d(t,"c",(function(){return h})),s.d(t,"a",(function(){return d})),s.d(t,"b",(function(){return i}));var n=s(1),a=s(0);const o="btn-outline-secondary";var r=window.ReactBootstrap;function i(e){return React.createElement("div",{style:{marginTop:20}},React.createElement(h,{button_groups:e.button_groups}),React.createElement(d,{resource_name:e.resource_name,res_type:e.res_type}))}class l extends React.Component{constructor(e){super(e)}render(){let e;return e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class,React.createElement(r.Button,{onClick:this.props.click_handler,className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name_text))}}l.propTypes={icon_name:PropTypes.string,click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,small_size:PropTypes.bool},l.defaultProps={small_size:!0};class c extends React.Component{constructor(e){super(e),doBinding(this)}render(){let e;e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class;let t=this.props.option_list.map((e,t)=>React.createElement(r.Dropdown.Item,{key:e.opt_name,onClick:e.opt_func},e.opt_name));return React.createElement(r.Dropdown,null,React.createElement(r.Dropdown.Toggle,{id:this.props.name,className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name)),React.createElement(r.Dropdown.Menu,null,t))}}c.propTypes={button_class:PropTypes.string,name:PropTypes.string,icon_name:PropTypes.string,option_list:PropTypes.array,small_size:PropTypes.bool},c.defaultProps={small_size:!0};class p extends React.Component{constructor(e){super(e),doBinding(this),this.state={file_list:null}}_handleFileChange(e){this.setState({file_list:e.target.files})}_do_submit(e){e.preventDefault(),this.props.click_handler(this.state.file_list)}render(){let e;e=this.props.small_size?"btn btn-sm action-button toolbar-button-sm "+this.props.button_class:"btn btn-sm action-button toolbar-button "+this.props.button_class;let t=React.createElement(r.Form.Control,{as:"input",type:"file",size:"sm",style:{width:250,fontSize:12},onChange:this._handleFileChange,className:"form-control-sm "+this.props.button_class,multiple:this.props.multiple});return React.createElement(r.Form,{inline:!0},React.createElement(r.Button,{onClick:this._do_submit,type:"submit",className:e},React.createElement("span",{className:"far button-icon fa-"+this.props.icon_name}),React.createElement("span",{className:"button-text"},this.props.name_text)),t)}}p.propTypes={click_handler:PropTypes.func,button_class:PropTypes.string,name_text:PropTypes.string,multiple:PropTypes.bool,icon_name:PropTypes.string,small_size:PropTypes.bool},p.defaultProps={small_size:!0,multiple:!1};class h extends React.Component{get_button_class(e){return null==e.button_class?o:e.button_class}render(){const e=[];var t=0;if(null!=this.props.popup_buttons&&0!=this.props.popup_buttons.length){let t=this.props.popup_buttons.map((e,t)=>React.createElement(r.ButtonGroup,{className:"toolbar-button-group",role:"group",key:"popup_group"+String(t)},React.createElement(c,{name:e.name,key:e.name,icon_name:e.icon_name,option_list:e.option_list,button_class:this.get_button_class(e)})));e.push(t)}for(let s of this.props.button_groups){let n=s.map((e,t)=>React.createElement(l,{name:e.name,icon_name:e.icon_name,click_handler:e.click_handler,button_class:this.get_button_class(e),name_text:e.name_text,key:t}));e.push(React.createElement(r.ButtonGroup,{className:"toolbar-button-group",role:"group",key:t},n)),t+=1}if(null!=this.props.file_adders&&0!=this.props.file_adders.length){let s=this.props.file_adders.map((e,t)=>React.createElement(p,{icon_name:e.icon_name,click_handler:e.click_handler,button_class:this.get_button_class(e),name_text:e.name_text,multiple:e.multiple,key:t}));e.push(React.createElement(r.ButtonGroup,{className:"toolbar-button-group",role:"group",key:t},s))}return React.createElement(r.ButtonToolbar,{className:"mb-2"},e)}}h.propTypes={button_groups:PropTypes.array,file_adders:PropTypes.array,popup_buttons:PropTypes.array},h.defaultProps={file_adders:null,popup_buttons:null};class d extends React.Component{constructor(e){super(e),this.state={current_name:e.resource_name},this.rename_me=this.rename_me.bind(this),this.RenameResource=null==this.props.handleRename?this.defaultRenameResource.bind(this):this.props.handleRename}rename_me(){console.log("entering rename");var e=this,t=this.props.res_type,s=this.state.current_name;$.getJSON($SCRIPT_ROOT+`get_resource_names/${t}`,(function(a){const o=a.resource_names,r=o.indexOf(s);r>=0&&o.splice(r,1),Object(n.b)(`Rename ${t}`,`Name for this ${t}`,e.RenameResource,s,o)}))}defaultRenameResource(e){const t={new_name:e};var s=this;Object(a.b)(`rename_resource/${this.props.res_type}/${this.state.current_name}`,t,(function(t){if(!t.success)return doFlash(t),!1;s.setState({current_name:e}),doFlash(t)}))}render(){let e=null==this.props.handleRename?this.state.current_name:this.props.resource_name;return React.createElement(r.Button,{id:"rename-button",className:"btn btn-outline-secondary res-name-button",onClick:this.rename_me},e)}}d.propTypes={resource_name:PropTypes.string,res_type:PropTypes.string,handleRename:PropTypes.func},d.defaultProps={handleRename:null}},,function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return p})),s.d(t,"c",(function(){return h})),s.d(t,"d",(function(){return d}));var n=s(7),a=s(10),o=s(1),r=s(5),i=s(3),l=s(0);const c=17;class p extends r.a{initialize_socket_stuff(){this.socket.emit("join",{room:window.user_id}),this.socket.emit("join-main",{room:window.resource_viewer_id}),this.socket.on("handle-callback",l.a),this.socket.on("stop-spinner",stopSpinner),this.socket.on("start-spinner",startSpinner),this.socket.on("close-user-windows",e=>{e.originator!=window.resource_viewer_id&&window.close()}),this.socket.on("doFlash",(function(e){doFlash(e)}))}}function h(e,t){function s(s){const n={res_type:e,res_name:t,new_res_name:s};Object(l.b)("copy_from_repository",n,doFlashAlways)}$.getJSON($SCRIPT_ROOT+`get_resource_names/${e}`,(function(n){showModal(`Import ${e}`,`New ${e} Name`,s,t,n.resource_names)}))}function d(e,t){function s(s){const n={res_type:e,res_name:t,new_res_name:s};Object(l.b)("send_to_repository",n,doFlashAlways)}$.getJSON($SCRIPT_ROOT+`get_repository_resource_names/${e}`,(function(n){Object(o.b)(`Share ${e}`,`New ${e} Name`,s,t,n.resource_names)}))}class u extends React.Component{constructor(e){super(e),this.savedContent=e.the_content,this.savedTags=e.tags,this.savedNotes=e.notes,this.hp_ref=React.createRef();let t=this;this.mousetrap=new Mousetrap,this.mousetrap.bind(["command+s","ctrl+s"],(function(e){t.props.saveMe(),e.preventDefault()})),this.update_window_dimensions=this.update_window_dimensions.bind(this),this.state={mounted:!1,usable_width:window.innerWidth-2*c-30,usable_height:window.innerHeight-50}}componentDidMount(){window.addEventListener("resize",this.update_window_dimensions),this.setState({mounted:!0}),this.update_window_dimensions(),stopSpinner()}update_window_dimensions(){this.setState({usable_width:window.innerWidth-2*c-30,usable_height:window.innerHeight-50})}get_new_hp_height(e){return this.state.mounted?this.state.usable_height-$(e.current).offset().top:this.state.usable_height-45}render(){let e=React.createElement(React.Fragment,null,this.props.children),t=this.get_new_hp_height(this.hp_ref),s=React.createElement(a.a,{tags:this.props.tags,created:this.props.created,notes:this.props.notes,handleChange:this.props.handleStateChange,res_type:this.props.res_type});return React.createElement(React.Fragment,null,React.createElement(n.b,{button_groups:this.props.button_groups,resource_name:this.props.resource_name,res_type:this.props.res_type}),React.createElement("div",{ref:this.hp_ref}),React.createElement(i.a,{left_pane:e,right_pane:s,available_height:t,available_width:this.state.usable_width}))}}u.propTypes={resource_name:PropTypes.string,res_type:PropTypes.string,button_groups:PropTypes.array,created:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,handleStateChange:PropTypes.func,meta_outer:PropTypes.string,saveMe:PropTypes.func,children:PropTypes.element}},function(e,t,s){"use strict";var n=s(4),a=s(0);function o(e){return React.createElement("button",{type:"button",className:e.classNames.selectedTag,title:"Click to remove tag",onClick:e.onDelete},React.createElement("span",{className:e.classNames.selectedTagName},e.tag.name))}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e};const i={position:"absolute",width:0,height:0,visibility:"hidden",overflow:"scroll",whiteSpace:"pre"},l=["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing"];class c extends React.Component{constructor(e){super(e),this.state={inputWidth:null}}componentDidMount(){this.props.autoresize&&(this.copyInputStyles(),this.updateInputWidth()),this.props.autofocus&&this.input.focus()}componentDidUpdate(){this.updateInputWidth()}copyInputStyles(){const e=window.getComputedStyle(this.input);l.forEach(t=>{this.sizer.style[t]=e[t]})}updateInputWidth(){let e;this.props.autoresize&&(e=Math.ceil(this.sizer.scrollWidth)+2),e!==this.state.inputWidth&&this.setState({inputWidth:e})}render(){const{inputAttributes:e,inputEventHandlers:t,query:s,placeholder:n,expandable:a,listboxId:o,selectedIndex:l}=this.props;return React.createElement("div",{className:this.props.classNames.searchInput},React.createElement("input",r({},e,t,{ref:e=>{this.input=e},value:s,placeholder:n,role:"combobox","aria-autocomplete":"list","aria-label":n,"aria-owns":o,"aria-activedescendant":l>-1?`${o}-${l}`:null,"aria-expanded":a,style:{width:this.state.inputWidth}})),React.createElement("div",{ref:e=>{this.sizer=e},style:i},s||n))}}function p(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}function h(e,t){if(t){const s=RegExp(p(t),"gi");e=e.replace(s,"<mark>$&</mark>")}return{__html:e}}function d(e,t,s,n){if(!n){const t=new RegExp(`(?:^|\\s)${p(e)}`,"i");n=e=>t.test(e.name)}return t.filter(t=>n(t,e)).slice(0,s)}class u extends React.Component{constructor(e){super(e),this.state={options:d(this.props.query,this.props.suggestions,this.props.maxSuggestionsLength,this.props.suggestionsFilter)}}componentWillReceiveProps(e){this.setState({options:d(e.query,e.suggestions,e.maxSuggestionsLength,e.suggestionsFilter)})}handleMouseDown(e,t){t.preventDefault(),this.props.addTag(e)}render(){if(!this.props.expandable||!this.state.options.length)return null;const e=this.state.options.map((e,t)=>{const s=`${this.props.listboxId}-${t}`,n=[];return this.props.selectedIndex===t&&n.push(this.props.classNames.suggestionActive),e.disabled&&n.push(this.props.classNames.suggestionDisabled),React.createElement("li",{id:s,key:s,role:"option",className:n.join(" "),"aria-disabled":!0===e.disabled,onMouseDown:this.handleMouseDown.bind(this,e)},React.createElement("span",{dangerouslySetInnerHTML:h(e.name,this.props.query)}))});return React.createElement("div",{className:this.props.classNames.suggestions},React.createElement("ul",{role:"listbox",id:this.props.listboxId},e))}}var _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e};const m={ENTER:13,TAB:9,BACKSPACE:8,UP_ARROW:38,DOWN_ARROW:40},g={root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled"};class y extends React.Component{constructor(e){super(e),this.state={query:"",focused:!1,expandable:!1,selectedIndex:-1,classNames:Object.assign({},g,this.props.classNames)},this.inputEventHandlers={onChange:()=>{},onBlur:this.handleBlur.bind(this),onFocus:this.handleFocus.bind(this),onInput:this.handleInput.bind(this),onKeyDown:this.handleKeyDown.bind(this)}}componentWillReceiveProps(e){this.setState({classNames:Object.assign({},g,e.classNames)})}handleInput(e){const t=e.target.value;this.props.handleInputChange&&this.props.handleInputChange(t),this.setState({query:t})}handleKeyDown(e){const{query:t,selectedIndex:s}=this.state,{delimiters:n,delimiterChars:a}=this.props;(n.indexOf(e.keyCode)>-1||a.indexOf(e.key)>-1)&&((t||s>-1)&&e.preventDefault(),this.handleDelimiter()),e.keyCode===m.BACKSPACE&&0===t.length&&this.props.allowBackspace&&this.deleteTag(this.props.tags.length-1),e.keyCode===m.UP_ARROW&&(e.preventDefault(),s<=0?this.setState({selectedIndex:this.suggestions.state.options.length-1}):this.setState({selectedIndex:s-1})),e.keyCode===m.DOWN_ARROW&&(e.preventDefault(),this.setState({selectedIndex:(s+1)%this.suggestions.state.options.length}))}handleDelimiter(){const{query:e,selectedIndex:t}=this.state;if(e.length>=this.props.minQueryLength){const s=this.suggestions.state.options.findIndex(t=>0===t.name.search(new RegExp(`^${e}$`,"i"))),n=-1===t?s:t;n>-1?this.addTag(this.suggestions.state.options[n]):this.props.allowNew&&this.addTag({name:e})}}handleClick(e){document.activeElement!==e.target&&this.input.input.focus()}handleBlur(){this.setState({focused:!1,selectedIndex:-1}),this.props.handleBlur&&this.props.handleBlur(),this.props.addOnBlur&&this.handleDelimiter()}handleFocus(){this.setState({focused:!0}),this.props.handleFocus&&this.props.handleFocus()}addTag(e){e.disabled||("function"!=typeof this.props.handleValidate||this.props.handleValidate(e))&&(this.props.handleAddition(e),this.setState({query:"",selectedIndex:-1}))}deleteTag(e){this.props.handleDelete(e),this.props.clearInputOnDelete&&""!==this.state.query&&this.setState({query:""})}render(){const e=this.props.tagComponent||o,t=this.props.tags.map((t,s)=>React.createElement(e,{key:s,tag:t,classNames:this.state.classNames,onDelete:this.deleteTag.bind(this,s)})),s=this.state.focused&&this.state.query.length>=this.props.minQueryLength,n=[this.state.classNames.root];return this.state.focused&&n.push(this.state.classNames.rootFocused),React.createElement("div",{className:n.join(" "),onClick:this.handleClick.bind(this)},React.createElement("div",{className:this.state.classNames.selected,"aria-live":"polite","aria-relevant":"additions removals"},t),React.createElement("div",{className:this.state.classNames.search},React.createElement(c,_({},this.state,{inputAttributes:this.props.inputAttributes,inputEventHandlers:this.inputEventHandlers,ref:e=>{this.input=e},listboxId:"ReactTags-listbox",autofocus:this.props.autofocus,autoresize:this.props.autoresize,expandable:s,placeholder:this.props.placeholder})),React.createElement(u,_({},this.state,{ref:e=>{this.suggestions=e},listboxId:"ReactTags-listbox",expandable:s,suggestions:this.props.suggestions,suggestionsFilter:this.props.suggestionsFilter,addTag:this.addTag.bind(this),maxSuggestionsLength:this.props.maxSuggestionsLength}))))}}y.defaultProps={tags:[],placeholder:"Add new tag",suggestions:[],suggestionsFilter:null,autofocus:!0,autoresize:!0,delimiters:[m.TAB,m.ENTER],delimiterChars:[],minQueryLength:2,maxSuggestionsLength:6,allowNew:!1,allowBackspace:!0,tagComponent:null,inputAttributes:{},addOnBlur:!1,clearInputOnDelete:!0},y.propTypes={tags:PropTypes.arrayOf(PropTypes.object),placeholder:PropTypes.string,suggestions:PropTypes.arrayOf(PropTypes.object),suggestionsFilter:PropTypes.func,autofocus:PropTypes.bool,autoresize:PropTypes.bool,delimiters:PropTypes.arrayOf(PropTypes.number),delimiterChars:PropTypes.arrayOf(PropTypes.string),handleDelete:PropTypes.func.isRequired,handleAddition:PropTypes.func.isRequired,handleInputChange:PropTypes.func,handleFocus:PropTypes.func,handleBlur:PropTypes.func,handleValidate:PropTypes.func,minQueryLength:PropTypes.number,maxSuggestionsLength:PropTypes.number,classNames:PropTypes.object,allowNew:PropTypes.bool,allowBackspace:PropTypes.bool,tagComponent:PropTypes.oneOfType([PropTypes.func,PropTypes.element]),inputAttributes:PropTypes.object,addOnBlur:PropTypes.bool,clearInputOnDelete:PropTypes.bool},s.d(t,"a",(function(){return T}));var f=window.ReactBootstrap;class b extends React.Component{constructor(e){super(e),doBinding(this),this.state={suggestions:[]}}componentDidMount(){let e=this,t={res_type:this.props.res_type,is_repository:!1};Object(a.c)("get_tag_list",t).then((function(t){let s=e._fillOutTags(t.tag_list);e.setState({suggestions:s})}))}_fillOutTags(e){return e.map((e,t)=>({id:t,name:e}))}_extractTags(e){return e.map(e=>e.name)}_handleDelete(e){let t=[...this.props.tags];t.splice(e,1),this.props.handleChange(t)}_handleAddition(e){let t=[...this.props.tags];t.push(e.name),this.props.handleChange(t)}render(){let e=this._fillOutTags(this.props.tags);return React.createElement(y,{tags:e,allowNew:!0,suggestions:this.state.suggestions,handleDelete:this._handleDelete,handleAddition:this._handleAddition})}}b.proptypes={tags:PropTypes.array,handleChange:PropTypes.func,res_type:PropTypes.string};class R extends React.Component{constructor(e){super(e),this.tags_field_ref=React.createRef(),this.tag_containing_div=React.createRef(),this.last_tags_list=[],this.setting_tags=!1,this.state={has_focus:!1},this.all_tags=[],doBinding(this)}get_tags_field(){return $(this.tags_field_ref.current)}_handleMyChange(e,t,s){this.setting_tags||this.props.handleChange(e,t,s)}create_tag_editor(e){let t=this,s={res_type:this.props.res_type,is_repository:!1};Object(a.c)("get_tag_list",s).then((function(s){t.all_tags=s.tag_list,t.get_tags_field().tagEditor({initialTags:e,forceLowercase:!0,autocomplete:{delay:0,position:{collision:"flip"},source:t.all_tags},onChange:t._handleMyChange,placeholder:"Tags..."})})).catch(doFlash)}componentDidMount(){this.last_tags_list=this.props.tags,this.create_tag_editor(this.props.tags)}componentDidUpdate(){this.props.tags!=this.last_tags_list&&(this.last_tags_list=this.props.tags,this.set_tag_list(this.props.tags))}get has_focus(){return this.tag_containing_div.current.contains(document.activeElement)}get_tags(){return this.get_tags_field().tagEditor("getTags")[0].tags}add_tags(e){let t=this.has_focus;this.setting_tags=!0;for(let s of e)this.get_tags_field().tagEditor("addTag",s,!t);this.setting_tags=!1}remove_all_tags(){let e=this.has_focus,t=this.get_tags();this.setting_tags=!0;for(let s of t)this.get_tags_field().tagEditor("removeTag",s,!e);this.setting_tags=!1}set_tag_list(e){null!=this.get_tags()&&(this.remove_all_tags(),this.add_tags(e))}render(){let e={pointerEvents:this.context.readOnly?"none":"all"};return React.createElement("div",{ref:this.tag_containing_div,style:e},React.createElement(f.Form.Control,{as:"textarea",ref:this.tags_field_ref,className:"metadata-field",rows:"1"}))}}R.contextType=n.a,R.propTypes={tags:PropTypes.array,handleChange:PropTypes.func,res_type:PropTypes.string};class w extends React.Component{constructor(e){super(e),this.state={md_height:500,show_markdown:!this.hasOnlyWhitespace&&this.props.show_markdown_initial},doBinding(this),this.notes_ref=React.createRef(),this.md_ref=React.createRef(),this.converter=new showdown.Converter,this.awaiting_focus=!1}getNotesField(){return $(this.notes_ref.current)}get hasOnlyWhitespace(){return!this.props.notes.trim().length}getMarkdownField(){return $(this.md_ref.current)}componentDidUpdate(){this.awaiting_focus?(this.focusNotes(),this.awaiting_focus=!1):this.state.show_markdown||this.notes_ref.current==document.activeElement||this._showMarkdown()}focusNotes(){this.getNotesField().focus()}_hideMarkdown(){this.awaiting_focus=!0,this.setState({show_markdown:!1})}_handleMyBlur(){this._showMarkdown(),null!=this.props.handleBlur&&this.props.handleBlur()}_showMarkdown(){this.hasOnlyWhitespace||this.setState({show_markdown:!0})}render(){let e=!this.hasOnlyWhitespace&&this.state.show_markdown,t={display:e?"none":"block",fontSize:14},s={display:e?"block":"none",maxHeight:this.state.md_height,fontSize:14};var n;e&&(n=this.converter.makeHtml(this.props.notes));let a={__html:n};return React.createElement(f.Form.Group,null,React.createElement(f.Form.Control,{as:"textarea",className:"metadata-field notes-field",ref:this.notes_ref,rows:"10",placeholder:"notes",style:t,onBlur:this._handleMyBlur,onChange:this.props.handleChange,readOnly:this.context.readOnly,value:this.props.notes}),React.createElement("div",{ref:this.md_ref,style:s,onClick:this._hideMarkdown,className:"notes-field-markdown-output",dangerouslySetInnerHTML:a}))}}w.contextType=n.a,w.propTypes={notes:PropTypes.string,handleChange:PropTypes.func,show_markdown_initial:PropTypes.bool,handleBlur:PropTypes.func},w.defaultProops={handleBlur:null};class T extends React.Component{constructor(e){super(e),doBinding(this)}_handleNotesChange(e){this.props.handleChange({notes:e.target.value})}_handleTagsChange(e,t,s){this.props.handleChange({tags:s})}_handleTagsChangeNative(e){this.props.handleChange({tags:e})}_handleCategoryChange(e){this.props.handleChange({category:e.target.value})}render(){let e,t={fontSize:14};if(null!=this.props.additional_metadata){e=[];for(let s in this.props.additional_metadata){let n=this.props.additional_metadata[s];if(Array.isArray(n))n=n.join(", ");else if("collection_name"==s){let e=/\.\w*$/.exec(n);null!=e&&(n=e[0].slice(1))}e.push(React.createElement("div",{style:t,key:s},React.createElement("span",{className:"text-primary"},s+": "),n))}}return React.createElement("div",{className:"combined-metadata",style:this.props.outer_style},null!=this.props.name&&React.createElement("h4",null,this.props.name),React.createElement(f.Form,null,React.createElement(f.Form.Group,null,React.createElement(f.Form.Label,null,React.createElement("span",{className:"text-primary"},"Tags")),React.createElement(b,{tags:this.props.tags,handleChange:this._handleTagsChangeNative,res_type:this.props.res_type})),null!=this.props.category&&React.createElement(f.Form.Group,null,React.createElement(f.Form.Label,null,React.createElement("span",{className:"text-primary"},"Category")),React.createElement(f.Form.Control,{as:"input",onChange:this._handleCategoryChange,value:this.props.category})),React.createElement(f.Form.Group,null,React.createElement(f.Form.Label,null,React.createElement("span",{className:"text-primary"},"Notes")),React.createElement(w,{notes:this.props.notes,handleChange:this._handleNotesChange,show_markdown_initial:!0,handleBlur:this.props.handleNotesBlur})),React.createElement("div",{style:t},React.createElement("span",{className:"text-primary"},"Created: "),this.props.created),null!=this.props.updated&&React.createElement("div",{style:t},React.createElement("span",{className:"text-primary"},"Updated: "),this.props.updated),null!=this.props.additional_metadata&&e))}}T.propTypes={outer_style:PropTypes.object,res_type:PropTypes.string,name:PropTypes.string,created:PropTypes.string,updated:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,category:PropTypes.string,handleChange:PropTypes.func,handleNotesBlur:PropTypes.func,additional_metadata:PropTypes.object},T.defaultProps={outer_style:{marginLeft:20},handleNotesBlur:null,category:null,name:null,updated:null,additional_metadata:null}},,,,,,,,,,,,function(e,t,s){"use strict";s.r(t);var n=s(9),a=s(4),o=s(0),r=s(6);class i extends React.Component{render(){return React.createElement("div",{id:"listarea-container"},React.createElement("textarea",{id:"listarea",style:{resize:"horizontal"},value:this.props.the_content,onChange:this.props.handleChange,readOnly:this.context.readOnly}))}}i.contextType=a.a,i.propTypes={the_content:PropTypes.string,handleChange:PropTypes.func,readOnly:PropTypes.bool};class l extends React.Component{constructor(e){super(e),this.savedContent=e.the_content,this.savedTags=e.tags,this.savedNotes=e.notes;let t=this;window.onbeforeunload=function(e){if(t.dirty())return"Any unsaved changes will be lost."},this.state={list_content:e.the_content,notes:e.notes,tags:e.tags},this.handleListChange=this.handleListChange.bind(this),this.handleStateChange=this.handleStateChange.bind(this)}get button_groups(){let e;e=this.props.is_repository?[[{name_text:"Copy",icon_name:"share",click_handler:()=>{Object(n.c)("list",this.props.resource_name)}}]]:[[{name_text:"Save",icon_name:"save",click_handler:this.saveMe},{name_text:"Save as...",icon_name:"save",click_handler:this.saveMeAs},{name_text:"Share",icon_name:"share",click_handler:()=>{Object(n.d)("list",this.props.resource_name)}}]];for(let t of e)for(let e of t)e.click_handler=e.click_handler.bind(this);return e}handleStateChange(e){this.setState(e)}handleListChange(e){this.setState({list_content:e.target.value})}render(){let e={readOnly:this.props.readOnly};return React.createElement(a.a.Provider,{value:e},React.createElement(n.a,{res_type:"list",resource_name:this.props.resource_name,button_groups:this.button_groups,handleStateChange:this.handleStateChange,created:this.props.created,notes:this.state.notes,readOnly:window.read_only,tags:this.state.tags,saveMe:this.saveMe,meta_outer:this.props.meta_outer},React.createElement(i,{the_content:this.state.list_content,handleChange:this.handleListChange})))}saveMe(){const e=this.state.list_content,t=this.state.tags.join(" "),s=this.state.notes,n=this.state.tags,a={list_name:this.props.resource_name,new_list_as_string:e,tags:t,notes:s};let r=this;Object(o.b)("update_list",a,(function(t){t.success&&(r.savedContent=e,r.savedTags=n,r.savedNotes=s,t.timeout=2e3);return doFlash(t),!1}))}saveMeAs(e){return doFlash({message:"not implemented yet",timeout:10}),!1}dirty(){let e=this.state.list_content;const t=this.state.tags,s=this.state.notes;return!(e==this.savedContent&&t==this.savedTags&&s==this.savedNotes)}}l.propTypes={resource_name:PropTypes.string,the_content:PropTypes.string,created:PropTypes.string,tags:PropTypes.array,notes:PropTypes.string,readOnly:PropTypes.bool,is_repository:PropTypes.bool,meta_outer:PropTypes.string},function(){Object(r.b)();let e=window.is_repository?"repository_get_list":"get_list",t=window.is_repository?"grab_repository_metadata":"grab_metadata";new n.b("main",5e3),Object(o.c)(`${e}/${window.resource_name}`,{}).then((function(e){var s=e.the_content;let n={res_type:"list",res_name:window.resource_name,is_repository:!1},a=document.querySelector("#root");Object(o.c)(t,n).then((function(e){let t=""==e.tags?[]:e.tags.split(" ");ReactDOM.render(React.createElement(l,{resource_name:window.resource_name,the_content:s,created:e.datestring,tags:t,notes:e.notes,readOnly:window.read_only,is_repository:window.is_repository,meta_outer:"#right-div"}),a)})).catch((function(){ReactDOM.render(React.createElement(l,{resource_name:window.resource_name,the_content:s,created:"",tags:[],notes:"",readOnly:window.read_only,is_repository:window.is_repository,meta_outer:"#right-div"}),a)}))})).catch(doFlash)}()}]);